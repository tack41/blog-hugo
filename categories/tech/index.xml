<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>tech on tack41&#39;s blog</title>
    <link>https://blog.tack41.net/categories/tech/</link>
    <description>Recent content in tech on tack41&#39;s blog</description>
    <image>
      <url>https://blog.tack41.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E</url>
      <link>https://blog.tack41.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E</link>
    </image>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Thu, 28 Apr 2022 00:00:00 +0900</lastBuildDate><atom:link href="https://blog.tack41.net/categories/tech/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>ChromeOSのclipboardの履歴はcrostiniで使えない</title>
      <link>https://blog.tack41.net/posts/2022/04/28_01/</link>
      <pubDate>Thu, 28 Apr 2022 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2022/04/28_01/</guid>
      <description>ChromeOSでは、 [search + v] というショートカットで過去にclipboardにコピーされた内容を5件まで表示し、選択してペーストできる機能があります。が、これ、crostini環境のterminalやvscodeには貼り付けられません。一覧表示まではできるのですが、選択しても貼り付けられないのです。
通常の[ctrl + v]で直近の内容のペーストはできるので、同じ対応が上記コピー履歴からの貼り付けまでは対応していないようです。残念です。</description>
    </item>
    
    <item>
      <title>WindowsFormでイベントを駆使して入力チェック等を行う場合のポイント</title>
      <link>https://blog.tack41.net/posts/2019/12/24_01/</link>
      <pubDate>Tue, 24 Dec 2019 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2019/12/24_01/</guid>
      <description> すべてのイベントハンドラを一括で登録、削除する関数を作成する すべてのイベントハンドラの最初で削除し、最後に再登録する  イベントの多重起動(Leaveイベント内で別ControlのFocusを実行して再度Leaveが実行される、等)を防ぐにはこれが確実 関数のreturn部分が複数あって複雑な場合は、try-finallyのfinally内で再登録する イベントハンドラから呼び出す関数内で削除,登録処理を行うと、その関数の呼ばれ方によって再登録が多重に行われてしまう可能性がある。関数を使う場合もイベントハンドラの中で直接一括削除、再登録を行う  複数のイベントハンドラが同じ処理をする場合でも、別のイベントハンドラを直接呼び出す実装をすると上記を満たさず破綻する。共通部分を別関数に切り出して使用する。      </description>
    </item>
    
    <item>
      <title>DataRow.Field&lt;int&gt; とConvert.ToInt32 の違い</title>
      <link>https://blog.tack41.net/posts/2019/11/08_01/</link>
      <pubDate>Fri, 08 Nov 2019 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2019/11/08_01/</guid>
      <description>DataRow.FieldとConvert.ToInt32 の違いについて、 int がstringになった場合でも同様。
DataRowの値がDBNullかどうかで分ける場合に
var val = (dr[&amp;#34;name&amp;#34;] == DBNull.Value) ? &amp;#34;&amp;#34; : Convert.ToString(dr[&amp;#34;name&amp;#34;]) とやっていたのだが、
var val = dr.Field&amp;lt;int?&amp;gt;(&amp;#34;name&amp;#34;) ?? &amp;#34;&amp;#34; と書けるという記事を発見し、早速使ってみたのだが&amp;hellip;
Field版では、データがdecimalの場合にInValidCastExceptionが発生してしまう。値の範囲がintの範囲に収まっているかどうかは関係ない。 利用しているデータがdecimalの桁数指定で定義している箇所がほとんどという性質のため、これでは全く使えないと判明した&amp;hellip;
ただ、Convert.ToString(DBNull.Value) はstring.empty(空文字)に、Convert.ToInt32(DBNull.Value)は0になるので、これがOKであればこれが最も手っ取り早いとわかった。
DataRowのFieldやGetValueOrDefaultのようなジェネリクスメソッドは型変換の範囲が厳しく、逆にConvert系はおおらかなのだろう。</description>
    </item>
    
    <item>
      <title>WindowsのMariaDBメジャーバージョンアップ後の運用の注意</title>
      <link>https://blog.tack41.net/posts/2019/11/03_01/</link>
      <pubDate>Sun, 03 Nov 2019 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2019/11/03_01/</guid>
      <description>WindowsのMariaDBを10.2 -&amp;gt; 10.4のようにメジャーバージョンアップする場合について。
バージョンアップ自体は公式サイトの手順に従って行えば良い。インストーラにより、上記の場合はバイナリはC:\Program Files\MariaDB 10.4、データはC:\Program Files\MariaDB 10.2を参照するようになる。MySQLサービスの実行パスは
&amp;#34;c:\Program Files\MariaDB 10.4\bin\mysqld.exe&amp;#34; &amp;#34;--defaults-file=C:\Program Files\MariaDB 10.2\data\my.ini&amp;#34; &amp;#34;MySQL&amp;#34; のようになる。
で、時間があるのでデータもバイナリも10.4のフォルダにするためにバックアップを取得した上で10.4をアンインストール、再度10.4をインストールすると、サービスが起動しない。 原因は上記実行パスのサービスがアンインストール時も消されずに残ってしまうためのよう。 MariaDBをすべてアンインストールした状態でsc delete MySQLを実行して残ったサービスを削除し、再度インストールすると正しい実行パスのサービスのエントリが生成される。</description>
    </item>
    
    <item>
      <title>Accessのレポート機能の活用</title>
      <link>https://blog.tack41.net/posts/2019/10/29_01/</link>
      <pubDate>Tue, 29 Oct 2019 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2019/10/29_01/</guid>
      <description>内製のシステムを、Accessベースから.Netに移行している。 その際に最大のネックになるのはレポート機能。
Accessのレポート機能は正直相当優秀だと思う。.Netの有償アプリで同等の機能を持つものを選定すると、開発者向けライセンスが100万レベルのものになってしまう。 それが、Officeの上位ライセンスに付属し、ランタイムだけなら無償で利用できる。
一方でネックはコードの開発生産性の低さ。VBAの文法は古めかしいし、何よりテキストではないのでGitで管理できない。
上記のいいとこ取りとして、Accessファイルのレポート機能だけを利用する方法を考えている。 Accessファイル側はレポートとレコードソースとなるテーブルのみ保持し、起動時にそのレポートが初期表示されるように設定しておく。
.Netのプロジェクト側では常に配布するコンテンツとしてAccessファイルを保持し、ADO経由でレコードソースとなるテーブルにデータを設定する。 その後外部プロセスとして該当のAccessを起動すると、レポートが表示される。 外部プロセスなので細かい制御はできないが、用途によっては十分だろう。
帳票数が多いアプリではきついかもしれないが、移行できない少数のレポートを活用する場合には十分かと思われる。</description>
    </item>
    
    <item>
      <title>NuGetライブラリ整理直後に謎のエラー</title>
      <link>https://blog.tack41.net/posts/2019/10/28_01/</link>
      <pubDate>Mon, 28 Oct 2019 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2019/10/28_01/</guid>
      <description>NuGetで使用するライブラリをVisualStuidoの管理画面より変更(削除-&amp;gt;追加)し、合わせて削除したライブラリに依存するライブラリを削除したところ、dllが存在しない旨を表すエラーが発生。 そのdllを見ると、削除したはずのdll。
App.configを見ると、その削除したはずのdllに関するdependentAssemblyエントリが合ったため、バックアップを取得した上で該当箇所を削除したところエラーは出なくなった。
Visual StudioでNugetライブラリを削除する場合には、設定ファイル(App.config)には連動されない場合があるらしい。</description>
    </item>
    
    <item>
      <title>Visual Studio 2017でReport Viewerの表示、編集ができない</title>
      <link>https://blog.tack41.net/posts/2019/10/04_01/</link>
      <pubDate>Fri, 04 Oct 2019 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2019/10/04_01/</guid>
      <description>Visual Studioで久しぶりにReport Viewerを編集しようとしたのだが、右クリックしても何も表示されない。 右上に右向きの矢印が表示されるはずなのだが、それもない&amp;hellip;
新しいフォームを作ってReportViewerをドロップしたところ、何も表示されない。
https://stackoverflow.com/questions/28179780/reportviewer-not-shown-on-form-designer-c-winform
を参考にInitializeComponentにコードを追加すると表示はされるが、やはり一切編集できない。
編集したい理由は、rdlcファイルを指定がエラーとなっていて編集し直したかったため。this.reportViewer1.LocalReport.ReportEmbeddedResource にrdlcファイルを直接指定する方法を試してみたが、GUIで指定したほうが有効になっているためか全く効かない。
最近.Net Coreのプロジェクトを作った際、Visual Studio CodeとIntellisenseがらみで干渉したため、いったんアンインストールしたことがあった。その際に設定がおかしくなったのかもしれない。 Visual StudioをいったんアンインストールしてOS再起動後にインストール。
Visual Studio 2017(Pro)をインストール後、拡張機能「Microsoft RDLC Report Designer」をインストール。 Microsoft.ReportingServices.ReportViewerControl.Winformsライブラリを、Visual Studio内のNuget管理画面にて、下げられる最低のバージョン140.337.80まで下げると編集メニューが表示される!!
ただ、既に作成済みのreportViewerはうまく動作しないため、いったん削除して同名で再作成して再配置。 その後、最新バージョンまで上げたが、正常に動作している。
一旦バージョンを下げることでキャッシュか何かがクリアされたのか? 原因不明。</description>
    </item>
    
    <item>
      <title>MySqlBulkLoaderでの取込結果が合わない</title>
      <link>https://blog.tack41.net/posts/2019/08/23_01/</link>
      <pubDate>Fri, 23 Aug 2019 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2019/08/23_01/</guid>
      <description>C#でMariaDBに接続する際にMySqlConnectorを利用している。
大量のデータを取り込む必要があったため、MySqlBulkLoaderで取り込んだところ、なんかゴミデータみたいのが入るうえに数字も合わない。 よくよく調べたところ、前段のCSV出力個所と、取込時の設定にミスがあった。
CSV出力時の改行の削除 CSV出力にはCSVHelper.CsvWriterを使用しているのだが、Fieldに改行があるとそのままCSVに出力される。CSVファイルは1行1データを前提としているので、ゴミデータが発生する原因になる。
csv.WriteField(col.ToString().Replace(&amp;#34;\r&amp;#34;, &amp;#34;&amp;#34;).Replace(&amp;#34;\n&amp;#34;, &amp;#34;&amp;#34;)) のように除去することで回避できた
FieldQuatationCharacterの設定 FieldTerminator, LineTerminator は普通に設定したのだが、FieldQuatationCharacter を設定しないと、CSVHelperがせっかく括弧で囲んでくれた中にカンマが含まれていると、そこで区切られてしまう。
mySqlBulkLoader.FieldQuotationCharacter = &amp;#39;&amp;#34;&amp;#39;; と指定することで回避できた。
MySqlConnector の MySqlBulkLoader は上記のような不具合で項目数など合わなくてもエラーなしで無理やり取り込むのが困ったところ&amp;hellip;</description>
    </item>
    
    <item>
      <title>IEnumerableで受けてIReadOnlyListで返すなら</title>
      <link>https://blog.tack41.net/posts/2019/08/09_01/</link>
      <pubDate>Fri, 09 Aug 2019 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2019/08/09_01/</guid>
      <description>http://tack41tu.hatenablog.com/entry/2019/02/28/092329
で記載した方針を受けて、最近はCollectionに関してはIEnumerableで受けて、IReadOnlyListで返す基本方針としている。 一方で、プロパティの変更による予期せぬ誤動作を防ぐために、POCOについてはコンストラクタで初期とを設定し、setterを提供しないことでImmutableな形としている。
ただ、そうなるとCollectionもコンストラクタで渡す必要があるが、アルゴリズムの関係などでCollectionのメンバーは後で追加したいことがある。例えばDBからデータを取得して、鑑データの属性として明細データのCollectionを持たせる場合に、鑑データのclassをいったん生成した後、明細データを都度追加したいことが多い。要は短期間だけメンバーを追加したい。
POCOに渡すCollectionの参照を呼び出し側で保持し、鑑データのコンストラクタに渡した後で呼び出し側で持っているCollectionの参照をもとにメンバーを追加したのだが、なぜか反映されない。
結論としては、POCO内ではCollectionをListとして保持しており、コンストラクタでIEnumerableで受けた際に直ちにtoListで変換していた。これだとその時点でオブジェクトがコピーされてしまい、呼び出し側で持っている参照とは別物になってしまう。 そこで、IEnumerableで受けたオブジェクトは内部的にもIEnumerableで保持し、getterで参照された際にtoListしてIReadOnlyList型として返すことで解決した。こうすれば呼び出し側で持っている参照とPOCOで持っているクラスは全く同じとなり、呼び出し側でメンバーを追加、削除すればPOCOにも反映される。getterで参照する場合はそもそもIReadOnlyList型としてわたるのでメンバーの編集はできない。castすればできなくもないかもしれないが、少なくともそれは保証対象外という意図を明示できる。</description>
    </item>
    
    <item>
      <title>rm /* やってしまった</title>
      <link>https://blog.tack41.net/posts/2019/07/26_01/</link>
      <pubDate>Fri, 26 Jul 2019 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2019/07/26_01/</guid>
      <description>やってしまいました。
rm ${HOGE}/* HOGEが未定義のため、ルートディレクトリのファイルが全削除。 幸い、rfオプションは付けていなかったので、消されたのはファイルのみ。
CentOS7において、ルートディレクトリに存在するファイルは以下のシンボリックリンク。
 /bin -&amp;gt; /usr/bin /lib -&amp;gt; /usr/lib /lib64 -&amp;gt; /usr/lib64 /sbin/ -&amp;gt; /usr/sbin  組み込み系のコマンドしかまともに動作せず、/usr/binフォルダに移動してコマンドを実行しても
-bash: /usr/bin/ln: /lib64/ld-linux-x86-64.so.2: bad ELF interpreter: となってしまう&amp;hellip;
なんとかググって見つけた以下のサイト
[https://ja.stackoverflow.com/questions/24643/rm-f-%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%97%E3%81%A6%E3%81%97%E3%81%BE%E3%81%84%E3%81%BE%E3%81%97%E3%81%9F:embed:cite]
# /usr/lib64/ld-linux-x86-64.so.2 --library-path /usr/lib64 /usr/bin/ln -s /usr/lib64 /lib64 # /usr/bin/ln -s /usr/bin /bin # ln -s /usr/lib /lib # ln -s /usr/lib64 /lib64 # ln -s /usr/sbin /sbin 上記コマンドで復旧した。神!! 感謝!!! 死ぬほど焦った&amp;hellip;
今覚えば、/usr/bin/busyboxを使えばよかったのかもしれない。
ちなみに、shebangにて
#!/bin/bash -eu とやっていたのだが、該当ファイルを/bin/bashの引数で呼び出したので効いていなかった&amp;hellip; shebangではなく本文中にset -euと書くことが大事だと、死ぬほど理解した.</description>
    </item>
    
    <item>
      <title>PowershellのToStringの書式指定ではまった</title>
      <link>https://blog.tack41.net/posts/2019/07/01_01/</link>
      <pubDate>Mon, 01 Jul 2019 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2019/07/01_01/</guid>
      <description>PowerShellのToStringで数値を書式指定で出力する際にはまった2点。どちらもエラーメッセージが適切ではなく、原因特定に苦労した。 PSVersion 5.1.14393.2969, Windows Server 2016上のISEで開発。Set-StrictMode -Version latest
書式#,#はダメ $num.ToString(&amp;#39;#,#&amp;#39;) にて$numが0だと「&amp;ldquo;ToString&amp;rdquo; のオーバーロードで、引数の数が &amp;ldquo;1&amp;rdquo; であるものが見つかりません。」と出る。
$num.ToString(&amp;#39;#,0&amp;#39;) とすることで、正しく出力される。
キャスト後のtoString $s_num=&amp;#34;99,999,999,99&amp;#34; の場合に書式指定で出力したい場合、いったんlongにキャストするので
[long]$s_num.ToString(&amp;#34;#,0&amp;#34;) と書くと、同様に「&amp;ldquo;ToString&amp;rdquo; のオーバーロードで、引数の数が &amp;ldquo;1&amp;rdquo; であるものが見つかりません。」とでる。正解は
([long]$s_num).ToString(&amp;#34;#,0&amp;#34;) キャスト演算子よりもToStringの方が優先度が高いのか&amp;hellip;</description>
    </item>
    
    <item>
      <title>.netで利用可能な帳票ツール</title>
      <link>https://blog.tack41.net/posts/2019/06/28_01/</link>
      <pubDate>Fri, 28 Jun 2019 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2019/06/28_01/</guid>
      <description>内製開発している.net(C#)で利用可能な帳票ツールについて調査した。結論としては、高いお金を出さないとまともなツールは手に入らないということ。 価格はすべて税抜き。
使えるが、高い  Create!Form: 1帳票設計ライセンス200,000円、1WindowsServerランタイム400,000円。帳票ツールは使いやすそうで機能も十分そうだが、高い&amp;hellip; Active Reports for .Net 12.0: 1開発ライセンス300,000円、サーバーライセンス(2core)120,000円。Create!Formと同様、機能は十分だが高い&amp;hellip; iTextSharp: 保守されている最新のVer.7(iText)では、ライセンスがAGPLかCommercial License。Commercial Licenseの費用は見積もりを取らないとわからないっぽいが、このサイトによると、1920ポンド(26万程度).. JasperReport: Jaspersoft Studioという設計ツールで設計は簡単そう。.Netから利用しようとすると、Serverを立ててAPI経由での利用だがCommunity ServerのライセンスがAGPLか商用ライセンスの購入が必要。価格は見つけられなかったが、上記製品と同価格帯だろう。&amp;hellip; LibraryはLGPLなのに&amp;hellip; クライアントをJavaで開発するのは、今の自分の開発スキル的につらい、つらすぎる&amp;hellip;  安いが、あまり使えない  Reports.net: 1開発ライセンス60,000円、ランタイムは無料。ヘルプ等を見る限り、ヘッダ・フッタやグルーピングという概念がなく、すべての項目を項目名を指定して出力し、ページ送りも自分で行う感じに見える。Excelに自分で出力するのと大差ない。 VB-Report 8: 1開発ライセンス85,000円、ランタイムは無料。Reports.netよりもさらに原始的で、ひな形Excelのセル番号を指定して出力する感じ。ひな形ExcelにClosedXMLあたりで出力したほうが早いやん。 Access: 14,800円。ランタイムは無料。一部内製アプリで使用しているが、 VBAは見捨てられた言語だし、ソースコードはいったんExportする必要があり、かつ元のバイナリには戻せない。開発しづらい。  無料だが、つらい  [Microsoft ReportViewer]: Visual Studio Proに添付。どっちにしろうちの開発用途ではCommunityは使えないので。ただ、社内帳票でよくある、1明細が複数行にわたる場合に対応できない。 ClosedXML.Report: 無料。よさそうだが、こちらも、1明細が複数行にわたる場合に対応できないっぽい。 帳票.NET: 無料。最終リリースが2016年。継続性に不安 Excel: 全利用者に配布済みなので追加費用不要。ClosedXML等を利用して普通にセル指定で出力。プログラムで頑張ってセルを指定して出力するか、ひな形にてデータの表示とは別にデータの入力個所をまとめておいてプログラム側の負荷を下げるか、どちらにしてもめんどい。帳票の種類が増えてくるとつらさが増してくる。  まともなツールは1開発者でも300,000円から400,000円程度は最低でも必要なのだろう。が、中小企業においてこの金額はおいそれとは出ない。今後も継続的にバージョンアップする必要があるだろうし。 ひとまず、帳票部分のみAccessで開発、そのAccessを.netプログラムに同梱して帳票部分で呼び出す形にできないか調査、ダメならExcelのひな型をなるべく工夫する。あまりにつらくて上記費用が安いと感じられるようであれば購入を申請する形か。</description>
    </item>
    
    <item>
      <title>Get-ChildItemからのLengthプロパティでのファイル容量取得ではまる</title>
      <link>https://blog.tack41.net/posts/2019/06/25_01/</link>
      <pubDate>Tue, 25 Jun 2019 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2019/06/25_01/</guid>
      <description>PowerShellで特定のフォルダ配下に存在する一定容量以上のファイルをリストアップするスクリプトを作成。
Get-ChildItem -Recurse . | Where-Object{$_.Length -ge 10*1024*1024 } よくあるお題であちこちにサンプルがあるのだが、なぜかLengthプロパティがないというエラーが出る。
色々調べた結果、Set-Strictのversionを2以上にすると発生することが分かった。1の場合には存在しないプロパティでも無視することで動作するようだ。
http://winscript.jp/powershell/131
や
https://stackoverflow.com/questions/44035319/get-childitem-length-is-wrong
によると、対象がdirectoryの場合に配下のFileInfoとDirectoryInfo配列のサイズを返すところ、配下が1つのみの場合だと存在するFileInfo,またはDirectoryInfoのLengthを返そうとするためで、無理やり配列にすればいけるとあるが、ダメ。Directoryに対しては配下にファイルが無くても、何個あってもLengthプロパティへの問い合わせはエラーとなる。PowerShell Ver.5.1.17763.503 on Win10 1809(64bit)で確認。
結論としては、Directoryの中の個数をカウントしてもしょうがないので、対象をファイルのみにすることだった。
Get-ChildItem -Recurse -File . | Where-Object{$_.Length -ge 10*1024*1024 } これであれば、Set-StrictのVersionがlatestでも通る。</description>
    </item>
    
    <item>
      <title>ClosedXMLにて印刷範囲が設定され、「(」を含むシート名を保存するとファイルが壊れる</title>
      <link>https://blog.tack41.net/posts/2019/03/11_01/</link>
      <pubDate>Mon, 11 Mar 2019 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2019/03/11_01/</guid>
      <description>ClosedXML 0.93.1, 0.94.2で確認。
印刷範囲を設定したファイルを開いて、「(」を含むシートを作成して保存すると、ファイルが壊れてしまいExcelでは開けなくなる。 workbook.xmlを見る限り、シート名をシングルクォーテーションでエスケープできていないのが問題のようだ。 再現ケースを確定してIssueに挙げるか。</description>
    </item>
    
    <item>
      <title>Form Load時にRadioButtonのCheckedChangedイベント発生</title>
      <link>https://blog.tack41.net/posts/2019/02/28_02/</link>
      <pubDate>Thu, 28 Feb 2019 01:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2019/02/28_02/</guid>
      <description>C# WinFormにてForm Load時にRadioButtonのCheckedChangedイベントが発生する事態に遭遇。 LoadイベントではCheckedをFalseにしているだけだし、他に怪しいイベントも見当たらない。
原因はTabStopが設定された、最小のTabIndexを持つフォームがRadioButtonになっていたため。</description>
    </item>
    
    <item>
      <title>C#でのCollection系オブジェクトの受け渡し指針</title>
      <link>https://blog.tack41.net/posts/2019/02/28_01/</link>
      <pubDate>Thu, 28 Feb 2019 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2019/02/28_01/</guid>
      <description>C#でCollection系オブジェクト(IEnumerable, ICollection, IList等)の受け渡しをどうすべきか悩んでいた。 ListよりIList, EnumerableよりIEnumerableといった実装を含まないInterfaceが好ましいのは当然として、 あらゆるオブジェクトを想定してより抽象的なクラスを選択すべきというのは感覚的にわかるのだが、どうもしっくりこない。
以下の記事を見てなるほどと思った。 https://enterprisecraftsmanship.com/2017/05/24/ienumerable-vs-ireadonlylist/
言語に依存しない一般的な方針としては、Postel’s law.として知られる(初めて知った&amp;hellip;)
 be conservative in what you send, be liberal in what you accept, C#における具体的な方針として
prefer IEnumerable when accepting a collection; prefer IReadOnlyList when returning one. 確かに、引数は抽象的な方が使いやすいが、戻り値も抽象的だと結局toListしたりcastしたりしないといけないので使いにくいし、そもそもそんな使い方が正しいとは思えないので違和感があった。
IEnumerable - ICollection - IListという階層関係があるので、引数としてconservativeな(他の継承クラスも受け取れる)IEnumerableがよいというのはそのとおりだろう。 ただ、be liberal であるための解としてIReadOnlyListがあげられているが、これは利用側で内容を変更しないことがはっきりしている場合だろう。変更することが想定する場合はIListを返すべきと思われる。
複数のオブジェクトを格納する際には、IListの実装クラスがほとんどなので、これ以外を考慮する必要はとりあえずないと思われる。 DictionaryやHashtableを使う場合はIDictionaryあたりを返すのが妥当か?</description>
    </item>
    
    <item>
      <title>CentOS 7のRedmine 4.0でrmagick build error.</title>
      <link>https://blog.tack41.net/posts/2019/02/18_01/</link>
      <pubDate>Mon, 18 Feb 2019 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2019/02/18_01/</guid>
      <description>CentOS7のDockerコンテナにてRedmineを構築中にrmagick buildにてエラー発生。 先週は動作したのだが&amp;hellip;
ログを見ると、rmagickのバージョンは3.0.0で要求するImageMagickは6.8.9以上。インストールされているのは6.7.8Q16のためエラーとなっている。
このrmagick3.0.0は2月16日にリリースされたばかりらしい。その際に要求するImageMagickのバージョンが上がったのだろう。
https://rubygems.org/gems/rmagick/
CentOSのリポジトリでは最新でも6.7しかない。remiリポジトリにあるようなのでインストールしたところ、buildエラーがなくなった。
rpm -ivh http://rpms.famillecollet.com/enterprise/remi-release-7.rpm yum -y install ImageMagick6 ImageMagick6-devel --enablerepo=remi </description>
    </item>
    
    <item>
      <title>MS Unit TestにおけるDeploymentItem</title>
      <link>https://blog.tack41.net/posts/2019/01/26_01/</link>
      <pubDate>Sat, 26 Jan 2019 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2019/01/26_01/</guid>
      <description>MS Unit Testにてテストファイルを配布してテストに利用する方法がようやくわかった。
ファイルをソリューションエクスプローラー上に登録して「出力ディレクトリにコピー」を「常にコピー」あたりにすればファイル名で参照できるのだが、ディレクトリは指定できないし、何よりリリースファイルに含まれてしまう。
https://stackoverflow.com/questions/16787003/deploymentitem-not-deploying-files
にあるとおり、ファイルのパスを指定する際に「....\」を追加したところ、正常に動作するようになった。 第二引数でディレクトリ名を指定すればそのディレクトリにコピーされる。</description>
    </item>
    
    <item>
      <title>Ubuntuでmac方式のIME切り替え</title>
      <link>https://blog.tack41.net/posts/2019/01/16_02/</link>
      <pubDate>Wed, 16 Jan 2019 01:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2019/01/16_02/</guid>
      <description>macを使い始めて、IMEの切り替え方式をmac方式に切り替えています。Windows10ではIMEの設定をいじっていますが、近い将来mac方式が標準になるようです。
http://www.itmedia.co.jp/news/articles/1812/26/news094.html
Ubuntu 18.04でも変更することができました。
https://garabakos.sakura.ne.jp/Zlinux/lx061.htm</description>
    </item>
    
    <item>
      <title>C#におけるIEnumerable,IEnumerator</title>
      <link>https://blog.tack41.net/posts/2019/01/16_01/</link>
      <pubDate>Wed, 16 Jan 2019 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2019/01/16_01/</guid>
      <description>IEnumerable(IEnumerator)はIListに比べると制約が多く、同じことをやろうとしても面倒、その分汎用性が高い、くらいに思ってました。
実際には、IEnumerableには要素の編集が一切できないのが最も大きな違いだと思います。
https://stackoverflow.com/questions/1210295/how-can-i-add-an-item-to-a-ienumerablet-collection
System.Linqを参照に追加すればIEnumerable.Appendが利用できますが、これはIList.Addとは違い非破壊的メソッドで自身は変更せずに要素を追加した新しいオブジェクトへの参照を返すだけです。 逆に言うと、一度設定したら編集しないCollectionを利用する場合はIEnumerableとして公開すればそとから編集されないことを保証できます。</description>
    </item>
    
    <item>
      <title>Java(Android)のService, Application(Context)</title>
      <link>https://blog.tack41.net/posts/2018/12/02_02/</link>
      <pubDate>Sun, 02 Dec 2018 01:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/12/02_02/</guid>
      <description>AndroidにてActivityにまたがる処理を行う処理を記述するには、Bound Serviceを使う必要がある。bindeServiceの引数ServiceConnectionのコールバック関数onServiceConnectedにて渡されるIBinderでServiceオブジェクトを取得し、必要なメソッドを実行できる。
SQLiteへの保存処理をこれで行おうと考えたのだが、そのためのSQLiteOpenHelperにはContextが必須となっている。
ServiceはActivity(Contextを継承する)に依存したくないために利用しているので、そのままContextを取得できない。 必要なメソッドの引数に都度Contextを指定する手も無くはないが、メソッドが増えるほど面倒さが増すし、そもそもDatabaseへのconnectの条件としてcontextが必要なので、メソッドの呼び出しの都度Databaseへの再接続が発生してしまう。
ApplicationもContextを継承している。これならどこからでも呼び出せそうだが、Applicationインスタンスを取得するにはActivityのメソッドを呼び出す必要がある&amp;hellip; ということで、Applicationを継承した独自クラスを作成し、Singletonとしてインスタンスを取得すると良いとわかった。よく使われている手法らしい。
http://kazuooooo.hatenablog.com/entry/2015/10/18/200949
これら独自Service, Applicationを利用する際の注意事項として、Application.manifestに宣言をしないといけない。これを忘れるとそれらをインスタンス化できずにnullになってExceptionが発生するが、エラー内容を一見してApplication.manifestが原因だとは判別できない。
Androidの各種メソッド・ライブラリには、この手のContext前提のものが多い。今回のSQLiteのライブラリに関しては内部で呼び出しているFileアクセスがContext前提となっているためのようだ。ただ、それがなぜContext前提にする必要があるかは理解できていない。C#のWPF, UWP関連でも似たような制限があった気がするので、現代的なアプリ開発には必要なセキュリティなどのための必須仕様なのかもしれない。</description>
    </item>
    
    <item>
      <title>AndroidStudioでEmulatorが起動するも接続できない。</title>
      <link>https://blog.tack41.net/posts/2018/12/02_01/</link>
      <pubDate>Sun, 02 Dec 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/12/02_01/</guid>
      <description>Android Studio 3.2.1(Windows64)にて、Emulataorが起動するのにアプリが全然起動しない状態になりました。 最下部にandroid waiting for target device to come onlineと表示されたままで変化せず、LogcatのデバイスリストにはにはDisconnectedと表示される状態。
https://stackoverflow.com/questions/42816127/waiting-for-target-device-to-come-online#43187806
のMarkDubyaさんが言うように、adb kill-serverを実行したらアプリが起動し、Logcatにログが出力されるようになった。 Windows 10でのadb.exeはC:\Users\(ユーザー名)\AppData\Local\Android\Sdk\platform-toolsにあった。</description>
    </item>
    
    <item>
      <title>Chromeの自動更新</title>
      <link>https://blog.tack41.net/posts/2018/11/30_02/</link>
      <pubDate>Fri, 30 Nov 2018 01:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/11/30_02/</guid>
      <description>Chromeの自動更新をADのグループポリシーで行っている。
https://support.google.com/chrome/a/answer/6350036?hl=ja
を参考に設定したが、更新されない。 以下の設定を追加で変更したところ、うまく動作するようになった。
 [Google Update]-[Application]-[Google Chrome]  Allow installation: 未構成 → 有効   [Google Update]-[Preferences]  Auto-update check period override: 1400 → 60    </description>
    </item>
    
    <item>
      <title>Excelでオプションボタン</title>
      <link>https://blog.tack41.net/posts/2018/11/30_01/</link>
      <pubDate>Fri, 30 Nov 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/11/30_01/</guid>
      <description>利用者が使い慣れたExcelでアンケートシートを作ろうとした際のこと。
どれか1つを選択してほしい場合は、オプションボタンを使う。開発タブにあり、フォームコントロールとActiveXの2つがある。
  フォームコントロール
 フォントの見た目がActiveXと比べればマシ。 グループ化するのに、グループポックスを使用しないといけない。  行や列の追加・削除でグループボックスに入ったり外れたりすると挙動が想定外となる レイアウト上、グループボックスが不要な場合は非表示にしないといけない。が、非表示にするとどこにあったかわからなくなる。 誤ってグループボックスが重なったりするとやはり想定外の挙動となる。      ActiveX
 グループ化するのにグループ名を指定できるので、フォームのように想定外の動作をすることはない フォントの見た目がひどい。クリックしたときとそうでないときで大きさが変わる? 項目Aを選択し、項目Bを選択してさらに項目Aを選択&amp;hellip;と繰り返すと、どんどんフォントが大きくなる(致命的)  プロパティ上のフォントサイズは変わっておらず、コントロールのサイズを変更すると直る。 当方では2013で発生。MSも認識はしているらしいが、対応作なし&amp;hellip;      https://support.microsoft.com/ja-jp/help/417966
ActiveXのフォントが大きくなる不具合は致命的なので、グループボックスの位置に注意しながらフォームコントロールを使うことにした。 どちらの場合もだが、オプションボックスをセル内に収まるようにしないと、セルの追加で配置がずれてしまうので注意。</description>
    </item>
    
    <item>
      <title>NECのEXPRESSSCOREのJavaアプレットが動かない</title>
      <link>https://blog.tack41.net/posts/2018/11/19_01/</link>
      <pubDate>Mon, 19 Nov 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/11/19_01/</guid>
      <description>当社ではNEC製サーバを導入しているのだが、NECサーバではサーバのステータス確認や設定変更にEXPRESSSCOREというWebコンソールが利用できる。 これが、一部機能がJavaアプレットで動く仕様になっている、今時&amp;hellip;
BIOS等の更新が出ているので適用しようと思い、現在のバージョンを確認しようとすると、このアプレットか、サーバを再起動して起動画面で確認するしかない&amp;hellip;
今時Javaアプレットが動くのはIEかSafariくらい。JREは8までしかサポートしない。 Windows 7 のIEでなんとか動かそうとするのだが、反応しない。
通常のブラウザで確認できる画面にsshの項目があり、これを有効にしたところsshでログインできた。ほしいバージョン情報も取得できた。 ただ、このまま開放しとくのも気持ち悪いので、必要なときだけsshを有効にする運用とした。</description>
    </item>
    
    <item>
      <title>MariaDBのON UPDATE CURRENT_TIMESTAMPに対するUPDATEの動作について</title>
      <link>https://blog.tack41.net/posts/2018/11/13_01/</link>
      <pubDate>Tue, 13 Nov 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/11/13_01/</guid>
      <description>リンク先同様、しばらく悩んでしまったのでメモ。
MySQLでON UPDATE CURRENT_TIMESTAMP で更新時にタイムスタンプを自動更新するように設定している場合でも、UPDATE前後で値に変化がなければタイムスタンプは更新されない。
[https://qiita.com/nao_tuboyaki/items/bef44862f6ddffd4f0b5][https://qiita.com/nao_tuboyaki/items/bef44862f6ddffd4f0b5)</description>
    </item>
    
    <item>
      <title>Bootstrapper().Run() 実行時にFileNotFoundException</title>
      <link>https://blog.tack41.net/posts/2018/10/09_01/</link>
      <pubDate>Tue, 09 Oct 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/10/09_01/</guid>
      <description>WPFでPrsimを習得しようと日々格闘中です。
ふとしたタイミングで、Bootstrapper().Run()実行時に
&amp;#34;ファイルまたはアセンブリ &amp;#39;System.Runtime, Version=4.1.2.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&amp;#39;、 またはその依存関係の 1 つが読み込めませんでした。指定されたファイルが見つかりません。 &amp;#34;:&amp;#34;System.Runtime, Version=4.1.2.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&amp;#34; なるエラーが表示されて進まなくなってしまいました。 シンプルなShellのみ起動するように修正してもダメ。NuGetですべてのライブラリを一旦アンインストールし、最小限のみとして前に正常に起動した状態に戻してもダメ。
どうやら、app.configとターゲットバージョンにより発生(自分のプロジェクトでは4.7.2)するらしい。
https://github.com/dotnet/standard/issues/567
Workaroundsにあるようにapp.configのdependentAssemblyタグをすべて削除し、ターゲットバージョンを一旦4.0にして再度4.7.2に戻したところエラーが消えて動作するようになった&amp;hellip;</description>
    </item>
    
    <item>
      <title>Visual Studio CodeでMarkdownのPreviewカスタマイズ</title>
      <link>https://blog.tack41.net/posts/2018/10/04_01/</link>
      <pubDate>Thu, 04 Oct 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/10/04_01/</guid>
      <description>はまった。
Windows上のVisual Studio CodeでMarkdown Previewをcssでカスタマイズすることがどうしてもできない。指定した cssファイルがないと言われる。
cssを絶対パスでは指定できないことは認識しており、Markdownファイルと同じパスにcssを置き、setting.jsonでファイル名のみ指定してもダメ。各種記事を見てそのままやってみたつもりでもうまく行かない。 markdown-pdf.styles で指定してPDF出力する分には問題ないのだが。
結論としては、ファイルサーバにおいてあるファイルの場合はダメなよう。ネットワークドライブを設定してもダメ。 ローカルに持ってきたら普通に動作した&amp;hellip; 半日無駄にした&amp;hellip; なお、ファイルサーバに置いていると画像も表示されない。Visual Studio CodeのMarkdown編集はファイルサーバ上のファイルとは相性が悪いと認識した。</description>
    </item>
    
    <item>
      <title>WPFのMVVMについて考える</title>
      <link>https://blog.tack41.net/posts/2018/10/01_01/</link>
      <pubDate>Mon, 01 Oct 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/10/01_01/</guid>
      <description>最近、Windows FormをやめてWPFのプログラムを書き始めている。
WPFは正直必要となる知識レベルが高く難しいというイメージで手が付けにくかった。今もそうだが。 何が難しいかといえば、MVVMの考え方をどこまで徹底するかに尽きるのではないかと思う。
MVVMについてまだまだ分からないことも多いが、今の認識をまとめる。
 MVVMは、ModelとViewの間にViewModelという層を挟み、ModelとViewの依存関係を疎にするモデル WPFの場合、ViewとViewModelの間でデータを複雑なコード不要でやりとりするBindingという機構があるので、うまく記述すればViewとViewModelの間も疎にできる そうすると、Model, ViewModelは変えずにViewだけ差し替えることも可能となる。 Windows Formの場合は、Viewの一部であるコードビハインドに処理もがっつり書いてしまうため、Viewだけ差し替えるということはできず結構な書き換えが必要となる。 Windows Formもそうだが、何も考えずに書くとどうしてもViewに処理を書いて肥大化しがち。そこで、ViewはViewModelの処理の呼び出しのみにする方が良いとされ、コードビハインドには極力コードを書かない方が良いとされる。 逆にViewModel側もViewに依存してしまうと別のViewに差し替えることができなくなるので、Viewに関するコードは書かない方が良いとされる。  MessageBoxのようなダイアログや、別のWindowを直接起動する処理すら良くないとされる。  じゃあどうするんだというと、Blendと言う部品や直接呼び出さずにInterface経由とすることで直接依存を避ける手段を取るべきとされる。これが初心者には超絶難解だと思う。     逆に、上記のようなViewを差し替える事態がそもそも考えなくて良いのであれば、今まで通りコードビハインドにコードを書いても問題はない。それでもWindows Formより洗練された部品が使えるのでメリットはある。  さしあたって、すぐに直面するのはViewModelからMessageBoxのような利用者への通知処理をどう行うか。行いたいのはMessageBoxを出すことではなく利用者にメッセージを伝えることと抽象化し、ShowMessageのようなメソッドをもつInterfaceを定義してこれを利用する形とする方法をとっている。以下のページが参考になった。
http://sourcechord.hatenablog.com/entry/2016/01/23/170753
このパターンは、コンストラクタに引き渡す処理に気をつければViewModelからのViewの呼び出しが簡単にできるため、よく使っています。</description>
    </item>
    
    <item>
      <title>ClosedXMLによるExcel編集がVirusBusterに強制終了させられる</title>
      <link>https://blog.tack41.net/posts/2018/09/14_01/</link>
      <pubDate>Fri, 14 Sep 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/09/14_01/</guid>
      <description>ClosedXMLで、ファイルサーバの雛形ファイルをもとに編集して出力するということをよく行います。 この際、ClosedXMLの保存先がファイルサーバだと、当社のVirus Buster Business SecurityにUnauthorized Encryptionと言われて 強制終了させられることがあります。Excelファイルは作成できず、exeも消されてしまうので再インストールとなります。
テストした結果、ClosedXMLでの保存先がローカルであれば問題ないことが確認できたので、ClosedXMLではローカルに一時フォルダを作成してそこに保存し、System.IO.File.Copyでコピーすることで解消しました。</description>
    </item>
    
    <item>
      <title>うっかりmasterリポジトリでcommit</title>
      <link>https://blog.tack41.net/posts/2018/09/13_02/</link>
      <pubDate>Thu, 13 Sep 2018 01:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/09/13_02/</guid>
      <description>git管理していて、ローカルリポジトリでブランチ切り忘れてmasterブランチで作業、ローカルcommitまでして気付いた。 このままpushしても、当然リモートのmasterブランチにダイレクトにpushはできず、弾かれる。 PRも出せない、と思っていたが。
pushでは、ローカルとリモートの両方のブランチを指定できる。
git push origin &amp;lt;local_branch&amp;gt;:&amp;lt;remote_branch&amp;gt; local_branchにmaster, remote_branchに本来切ろうと思っていたブランチ名を指定し、そのブランチでPRを出す。</description>
    </item>
    
    <item>
      <title>ClosedXMLでWindows7だけレイアウトが崩れる</title>
      <link>https://blog.tack41.net/posts/2018/09/13_01/</link>
      <pubDate>Thu, 13 Sep 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/09/13_01/</guid>
      <description>アホな話です。
ClosedXMLで、一部コードでうっかり以下のようなコード書いてました。
 using (IXLWorkbook targetBook = new XLWorkbook(filePath))  {  using (IXLWorksheet targetSheet = targetBook.Worksheet(1))  {   }   targetBook.Save();  } usingの入れ子です。 普通、入れ子になるような階層があれば一番上位のクラスが下位のDispose呼んでくれるっと思いますよね〜。 でも、このときはusing句覚えたてで、とにかく使いたかったんです、using入れ子かっけ〜って思ってたんです&amp;hellip;
症状としては、Windows 7の場合のみシートのフォーマットが崩れます。なぜかWindows 10は大丈夫。OSによって症状が違う理由は不明。 sourceを見ると、XLWorksheetのDisposeでrange情報をクリアしてるっぽいから、そこで情報が消えて、そのまま保存すればそりゃレイアウトは崩れるな〜と。
追記) どうも、最新の0.93.1で発生し、0.92.0では発生しなかったようだ。ライブラリのバージョンアップした途端に大量に問い合わせが&amp;hellip;</description>
    </item>
    
    <item>
      <title>今日のクソVBAコード</title>
      <link>https://blog.tack41.net/posts/2018/09/10_01/</link>
      <pubDate>Mon, 10 Sep 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/09/10_01/</guid>
      <description>stDocName = ChrW(xx) &amp;amp; ChrW(yy) &amp;amp; ChrW(zz) &amp;amp; ChrW(abc) &amp;amp; ChrW(def) &amp;amp; ChrW(ghi) &amp;amp; ChrW(jkl) &amp;amp; ChrW(mno) &amp;amp; ChrW(pqr) &amp;amp; ChrW(stu) DoCmd.OpenReport stDocName, acPreview ChrWの引数は実際にはコードが入る。 式の右辺をイミディエイトウィンドウに入力すると、日本語のレポート名が表示される&amp;hellip;
暗号化?なんのために? あとで見る人への嫌がらせか? ちょっと意味がわからない</description>
    </item>
    
    <item>
      <title>CIの導入について検討</title>
      <link>https://blog.tack41.net/posts/2018/08/27_02/</link>
      <pubDate>Mon, 27 Aug 2018 01:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/08/27_02/</guid>
      <description>一人で開発していても、テストやデプロイにミスが出る可能性はある。 CIの導入を検討した。
結論としては、CI用途のサーバーを別途導入することはしない。現在主に開発しているC#プロジェクトでは、CIにもWindowsが必要となる。ライセンス費用が必要だし、Dockerでお手軽に再構築できる環境としたいため。
やりたいことは以下の通り
 リポジトリのPRコードのビルド テスト、結果通知、OKならmerge DBの構成情報に関して、リポジトリと実環境で差異がないかチェック  1,2点目はWindowsを避ける以上、不可能。開発時に自端末でテストを行い、PRのコメントに記載する運用で対応。 3点目は、毎日定時に実行する普通のバッチでなんとかなるレベル。
テストに関して、DBに関連するところは一切やっていない。面倒なので。 一方で内製アプリの殆どはDBのデータを持ってきてそのまま表示し、加工して更新する程度のものがほとんどのため、結果ほとんどテストがない状態。 本番環境に接続する際には専用のクラスを利用しているので、テスト環境用にも同様のクラスを作成し、テスト実行時にはそちらを利用してDB接続するようにしてテストを行うようにする。まずこちらが優先。
Dockerでdumpファイルから空のデータベースを作成するDockerfileを作成し、開発にすぐに利用できるようにする。
その上で、上記の運用で品質をさらに高めていく。</description>
    </item>
    
    <item>
      <title>Docker Container 起動失敗</title>
      <link>https://blog.tack41.net/posts/2018/08/27_01/</link>
      <pubDate>Mon, 27 Aug 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/08/27_01/</guid>
      <description>Docker Hostのスタートアップサービスにて、Docker ContainerをBuild, Upするスクリプトを実行しているのですが、以下のようなエラーが大量に発生してUpしていませんでした。
 8月 26 03:07:44 sever-name dockerd-current[864]: time=&amp;#34;2018-08-26T03:07:44.615597202+09:00&amp;#34; level=error msg=&amp;#34;could not calculate checksum for \&amp;#34;fb1077f711d4fc436c0b6e115f8cdb0c871f46c818ec998efbf489df5e4a4de5\&amp;#34;, \&amp;#34;devmapper: Unknown device fb1077f711d4fc436c0b6e115f8cdb0c871f46c818ec998efbf489df5e4a4de5\&amp;#34;&amp;#34; ...  8月 26 03:07:44 server-name dockerd-current[864]: time=&amp;#34;2018-08-26T03:07:44.617971873+09:00&amp;#34; level=error msg=&amp;#34;migration failed for 866ae31005298fd6f1bb2944418eb34969b16ead2a18ed332fa011a311f3b4b2, err: open /var/lib/docker/graph/60e65a8e4030022260a4f84166814b2683e1cdfc9725a9c262e90ba9c5ae2332/json: no such file or directory&amp;#34; ... ログの内容を見ると、以下のissueと同じように見える。再起動前にDockerのバージョンが1.13.1-74 に上がったようだし&amp;hellip;
https://github.com/moby/moby/issues/20147
対処方法は記事からは判明せず。
スタートアップスクリプトを手動で実行したところ、普通にupしたので、docker containerが起動していなければスクリプトを再度実行するcronジョブを登録することで暫定対処した。</description>
    </item>
    
    <item>
      <title>Access 2003からMariaDBに移行</title>
      <link>https://blog.tack41.net/posts/2018/08/19_01/</link>
      <pubDate>Sun, 19 Aug 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/08/19_01/</guid>
      <description>内製のAccess 2003アプリを、DB部分はMariaDBに移行している。 フロントは.Net(C#)
ツールを使って工数を削減できないかと模索したが、以下のような正攻法で攻めるしかないと言う結論に達した。
 Access側のテーブルにて、極力Not Null制約を適用する&amp;hellip; 後述のデータ移行クエリ実行の際、NullがあるとINSERT SELECT 文がこけるため、Nullの場合とそうで無い場合で別クエリを実行する必要が出てくるため。
文字列型は、NULL=空文字と考えて問題ない場合がほとんどと想定されるので、以下の手順を機械的に実行する。
文字列でない場合はNULLを置き換えるべき値が自明でない場合も多いので、一旦NULL値固定で移行し、列ごとに個別で移行(UPDATE DEST.COL=SRC.COL WHERE SRC.COL IS NOT NULL)  対象列の空文字を許可する。 該当列を更新する部分にてNULLの場合は空文字に置き換える処理を追加  画面のフォームがデータと連結していてSQLではなくDoCmdで処理している場合、後付でSQLを組み込むと競合エラーが面倒なので、単純にフォームの値をNz関数でNullを置換してやれば良い ウィザードに従って作成した画面などで、データ更新処理を明示的に記載されていない場合は、フォームの追加・更新前処理イベントにてNz関数を適用する   UPDATE文で該当列のNULLを空文字に置換 該当列にNOT NULL制約を適用。   MariaDB側に、同一レイアウトのテーブルを新規作成。参照制約も実装。 MariaDBのODBCドライバをインストールし、対象のMariaDBをODBC登録。 AccessのリンクテーブルとしてMariaDBのテーブルを登録 AccessのテーブルからMariaDBのテーブルにデータを流し込む(INSERT SELECT)クエリを作成、初回の移行を行う。
参照整合性制約から、移行可能な順番がはっきりする。 MariaDBのデータに対してアクセスするフロントプログラムを作成する。  移行後のテーブルレイアウトそのものでプログラムの動作検証が可能。   フロントプログラムの作成が完了したら、MariaDBの全データをTruncateしてデータの本番移行を行う。  データ移行の逆順で実行しても参照整合性制約からデータを削除できない場合がある。素直に参照整合性制約を一時削除し、データの削除完了後に再度作成する。    テーブル名や列名にスペースやマルチバイト文字が入ってて命名規則を満たしていない、明らかに数量データなのに文字列型になっている&amp;hellip;といった問題はこれ以降にじっくりリファクタリングしていく。上記の手順とリファクタリングを同時に行うのはリスクが大きい。</description>
    </item>
    
    <item>
      <title>CentOS7のDocker構築ではまったこと</title>
      <link>https://blog.tack41.net/posts/2018/08/16_01/</link>
      <pubDate>Thu, 16 Aug 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/08/16_01/</guid>
      <description>storage driverがdevice mapperの場合のディスク容量 device mapperの場合は、既定のディスク容量が10GBほどとなる。Oracle DatabaseのDockerコンテナをbuildするとこける。
storage driverを最初からoverlay2 にするための方法 インストール時にデバイスタイプにLVMを指定すると、Dockerのstorage dirverはdevice mapperになる。
https://docs.docker.com/storage/storagedriver/select-storage-driver/#supported-backing-filesystems
基本ディスクを選んで、xfsを選んでやる必要がある。
さらに、CentOS7 1511(minimal)の場合は上記の手順でもやはりdevice mapperが既定となる。overlayを使用するための設定がされていないためと想像される。
https://docs.docker.com/storage/storagedriver/overlayfs-driver/
CentOS7 1804(minimal)で基本ディスク(xfs)でインストールすれば、overlay2がstorage driverとして設定される。</description>
    </item>
    
    <item>
      <title>箱入り娘のプログラムを書いて思う</title>
      <link>https://blog.tack41.net/posts/2018/08/15_01/</link>
      <pubDate>Wed, 15 Aug 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/08/15_01/</guid>
      <description>実家に帰った際に箱入り娘のパズルがあったのでやっていた。
https://ja.m.wikipedia.org/wiki/%E7%AE%B1%E5%85%A5%E3%82%8A%E5%A8%98_(%E3%83%91%E3%82%BA%E3%83%AB)
全然解けなかったが、プログラムで力技で解きたいと思い、やってみた 結論として、解けずに終わった。 Pythonで再帰関数で解こうとして、再帰呼び出しの上限に引っかかって30sほどでエラーとなった。 将棋などと比較すると取ることができる手ににかなりきつい制限があるので、全探索余裕と思ってしまったのだが、完全に間違っていた。 一応、盤面を都度記録し、同じ盤面になったらそれ以上は探索しないようにしたのだが、それでも解空間は大きかった。
まず、再帰による解法の選択について。現代のプログラムにおいては、上限の大きさは違えど再帰呼出の階数には制限がある。ので、対象としている問題で想定される階数に比較してプログラミング言語の制約が十分かどうか判断しなければいけなかった。あるいは、階数をパラメータとして保持しておき、起動時に何階層まで探索するか指定するような形にすればよかった。
再帰ではなく、盤面をメモリかファイルに記録し、都度記録から次の盤面を探してスタックを使用しない形にしても良かった。
そもそも論で行くと、パズルは頭の体操として娯楽としてあるもので、力技で解くことに意味あるのか? というのもある。
今回は、初めてPythonを使って割としっかりとしたプログラムが書けたので、練習として良かったということにした。</description>
    </item>
    
    <item>
      <title>Excelで「このワークシート内にある1つ以上の式の参照に問題が見つかりました」</title>
      <link>https://blog.tack41.net/posts/2018/08/03_01/</link>
      <pubDate>Fri, 03 Aug 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/08/03_01/</guid>
      <description>Excelで解決がとてもめんどくさいエラー。
このワークシート内にある１つ以上の式の参照に問題がみつかりました。数式内のセル参照、範囲名、定義名、および他のブックへのリンクがすべて正しいことをご確認ください。 Excel 2013で発生し、どう考えても参照する箇所がなくなるくらい該当シート、セルを削除しても保存のたびにエラーが出る。
で、一旦保存して終了して開き直すと出なくなることも&amp;hellip; 全てではないのだが、エラー箇所を修正しても保存して開き直すまでエラーが出続けることがあるらしい&amp;hellip; そもそも、エラーを出すのだからそのエラー箇所を素直に指摘してくれよと思うのだが&amp;hellip;</description>
    </item>
    
    <item>
      <title>64bit OSでのレジストリ操作時の注意事項</title>
      <link>https://blog.tack41.net/posts/2018/07/30_03/</link>
      <pubDate>Mon, 30 Jul 2018 02:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/07/30_03/</guid>
      <description>http://tack41tu.hatenablog.com/entry/2018/07/30/214927
でClickOnceアプリをインストールする際にレジストリを編集する必要がある事を書いた。
レジストリエディタで編集するのは面倒だし運用も大変なので、レジストリを編集するアプリを作成した。
https://msdn.microsoft.com/en-us/library/ee308453.aspx
にある以下のコードを書いて実行し、正常終了するのだがレジストリエディタで確認すると変更が反映されておらず、ClickOnceの動作も変わらない。
Microsoft.Win32.RegistryKey key; key = Microsoft.Win32.Registry.LocalMachine.CreateSubKey(&amp;#34;SOFTWARE\\MICROSOFT\\.NETFramework\\Security\\TrustManager\\PromptingLevel&amp;#34;); key.SetValue(&amp;#34;LocalIntranet&amp;#34;, &amp;#34;Enabled&amp;#34;); key.Close(); どうもレジストリは32bit, 64bitで別の領域らしく、プログラム作成時にターゲットCPUをAnyとし、x86優先とした結果、32bitの領域を更新してしまっているらしい。
https://aonasuzutsuki.hatenablog.jp/entry/2015/12/08/173819
を参考に以下のように記載したところ、想定通りに動作するようになった。
Microsoft.Win32.RegistryKey key_base, key; key_base = RegistryKey.OpenBaseKey(RegistryHive.LocalMachine, RegistryView.Registry64); var key = prerKey.CreateSubKey(&amp;#34;SOFTWARE\\MICROSOFT\\.NETFramework\\Security\\TrustManager\\PromptingLevel&amp;#34;,); key.SetValue(&amp;#34;LocalIntranet&amp;#34;, &amp;#34;Enabled&amp;#34;); key.Close(); </description>
    </item>
    
    <item>
      <title>Microsoft Report使用時のビルド時の警告</title>
      <link>https://blog.tack41.net/posts/2018/07/30_02/</link>
      <pubDate>Mon, 30 Jul 2018 01:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/07/30_02/</guid>
      <description>Visual Studio 2017にてMicrosoft Reportを使用するために、Nugetで[Microsoft Rdlc Report Designer for Visual Studio]をインストールすると、ビルド時に「同じ依存アセンブリの異なるバージョン間での競合が見つかりました。」と警告が表示される。実行自体は問題なくできる。
https://qiita.com/hahifu/items/8dba20cd06fb0c3a9fa7
を参考に出力の詳細レベルを上げて確認すると、ReportのアセンブリがSQLServer.Typesの12.0.0に依存している一方で、NugetでReportインストール時に一緒にインストールされるSQLServer.Typesは14.0.0であるためのようだ&amp;hellip;
依存関係の解消方法が思い付かず、また動作には影響はないため以下のサイトを参考に
https://docs.microsoft.com/ja-jp/dotnet/framework/configure-apps/how-to-enable-and-disable-automatic-binding-redirection
自動バインド リダイレクトを有効化したところ、警告は出なくなった。</description>
    </item>
    
    <item>
      <title>ClickOnceでハマる</title>
      <link>https://blog.tack41.net/posts/2018/07/30_01/</link>
      <pubDate>Mon, 30 Jul 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/07/30_01/</guid>
      <description>C#で開発したクライアントアプリケーションをClickOnceで配布する際にハマった2点
Windows10へのインストール イントラのファイルサーバに置いてある証明書が設定されていないClickOnceをWindows 10で実行すると、「コンピューターにセキュリティ上の問題を発生させるため、管理者がこのアプリケーションをブロックしました。&amp;hellip;」と表示され、[閉じる]ボタンしか表示されないために、インストールができない。 Windows 7では普通にインストールできる。
https://answers.microsoft.com/ja-jp/windows/forum/apps_windows_10-winapps-appscat_tools/%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC/45f6621c-35ca-4395-bdd4-685705e9fae0
にあるレジストリの[LocaIntranet]の値をEnabledにする必要があった。 設定変更は直ちに反映される(OS再起動は不要)
関連アセンブリの添付 上記をクリアしたうえでClickOnceを公開し、クライアントで実行すると以下のエラーが表示される。
このアプリケーションをインストールまたは実行できません。このアプリケーションでは、まずグローバルアセンブリキャッシュ(GAC)にアセンブリ Microsoft.**** バージョン *** をインストールする必要があります。 ****にはVisualStudio関連のアセンブリ各種が出力される。Visual Studio 2017 Express Desktopの時は発生しなかったのだが、2017 Professionalにしたら発生した。 どうも必要なアセンブリ(.dll)を添付できていないようで、事例は異なるが、
http://thinkami.hatenablog.com/entry/2014/09/09/062440
にあるように公開設定で全てのアセンブリを「必須コンポーネント(自動)」→「含む」に変更すると解消した。</description>
    </item>
    
    <item>
      <title>実行順序に依存する複数LINQ実行時の遅延評価による副作用</title>
      <link>https://blog.tack41.net/posts/2018/07/19_01/</link>
      <pubDate>Thu, 19 Jul 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/07/19_01/</guid>
      <description>例えば、LINQ1にて元データよりデータを抽出し、これをデータセット1とする。 次に、LINQ2にて、元データからデータセット1を除いたデータセットに対して抽出し、これをデータセット2とする。 これをLINQ3にて、元データからデータセット1とデータセット2を除いたデータセットに対して抽出し、これをデータ・セット3とする。 &amp;hellip;.
上記のような処理を1メソッドで行う。 後続のLINQで除外するために、除外するためのデータセットを例えばListとして保持する。
LINQ2はLINQ1の結果が決まらないと決まらない。LINQ3はLINQ2, LINQ1の結果が決まらないと決まらない。だが、後続のLINQに対して結果を伝えるのは(LINQとは無関係の)Listオブジェクト。
このような場合に、上記LINQを順番にコードで記載したとしても、除外Listの値は後続に伝わらない(ことがある?)。おそらく、プログラムの動作として最初にLINQ3の結果を参照した場合にLINQ1,LINQ2の結果を行ってから、という動きはしてくれず、結果、空の除外Listに対してLINQ3を実行してしまっているためと思われる。
遅延されるのが問題なので、LINQの実行結果 IEnumerable型のオブジェクトに対してToList()を実行してやれば即時に確定してこのような副作用は発生しなくなる。遅延評価のメリットは当然なくなるが。</description>
    </item>
    
    <item>
      <title>C#でExcelのバージョンに依存しないCOM経由での操作</title>
      <link>https://blog.tack41.net/posts/2018/07/04_01/</link>
      <pubDate>Wed, 04 Jul 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/07/04_01/</guid>
      <description>C#での社内プログラムでExcelを操作する際、大部分はClosedXMLを利用しているのだが、ActiveXを使用しているなどでうまく動作しない場合にはCOM経由で操作している。
Visual Studioで参照ツリーにExcelのCOM参照を追加するのだが、その時点でPCにインストールされているOfficeのバージョンに対応したCOMを追加する形になる。
ビルド時に参照ツリーにあるCOMを参照するため、参照追加時のPCとビルド時のPCでインストールされているOfficeのバージョンが異なると、ビルド時に警告、またはエラーとなる。
参照追加時には2013、ビルド時に2016だったためにビルド時に警告が出て、そのまま実行すると該当箇所でRuntime Errorでコケる事象が発生した。 社内には、今後2013, 2016が混在する予定のため、どちらかだけしか対応できないとなると困るので、対応方法を調査した。
参照ツリーに追加して開発する形式を事前バインディング、実行時にCOMの名前から該当のCOMを参照する形式を遅延(動的)バインディングというらしい。
 事前バインディング  Visual StudioでCOMオブジェクトの仕様を把握しているため、補完が効いて開発効率が高い 型情報なども取得済みでコンパイルするため、実行速度は遅延バインディングと比較して速い 使用するOfficeのバージョンを指定する必要がある。   遅延バインディング  使用するOfficeのバージョンを指定する必要がない Visual Studioでの補完は効かず、各オブジェクト、メソッドの情報を調べながら呼び出す必要がある。大変。 実行時に型チェックを行うため、遅い。実行時エラーが出る可能性も。    遅延バインディングは、各メソッドをInvokeMemberで引数を調査しながら呼び出す必要があり、とても大変。以下のサイトにこの大変さをWrapするコードが公開されていた。
https://zenmai.wordpress.com/2011/06/24/excel%E3%81%AE%E5%8F%82%E7%85%A7%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%9B%E3%81%9A%E3%81%ABexcel%E3%82%92%E4%BD%BF%E3%81%86c/
とても素晴らしいのでぜひ利用しようと考えたのだが、(当然ながら)COMオブジェクトのすべてが実装されているわけではないので不足個所を追加実装する必要があり、結構大幅な追加が必要と思われた。
で、たどり着いたのがこちらの記事。
https://teratail.com/questions/109579
なんと、dynamicという宣言に変更するだけで、ビルド時のチェックはやめて実行時に動的に呼び出してくれるとのこと。 (COMオブジェクトの生成部分は固有の書き方への変更が必要)。素晴らしい!!
実際にdyamicに変更したところ、WorkbookオブジェクトへのReleaseComObject呼び出し時にエラーが発生。
http://hiro-syumi.ldblog.jp/archives/36511362.html
こちらの記事を参照させてもらってエラー箇所のみobject型へのキャスト処理を追加したところ、問題なく動作するようになった。
このdynamicの利用だが、最初からこれを前提に行うと上記の通りVisualStudioによるサポートが効かないので開発効率はかなり落ちると思われる。今回のようにCOM参照を追加して事前バインディングで実装したうえで、dynamicに書き換えるという形が効率が良いと感じた。</description>
    </item>
    
    <item>
      <title>Windows 2016でプログラムが起動しない</title>
      <link>https://blog.tack41.net/posts/2018/05/15_01/</link>
      <pubDate>Tue, 15 May 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/05/15_01/</guid>
      <description>当社で利用している手形管理のシステムにて、辞書の更新をしようとしたところ、なぜかexeをクリックしても起動しない症状が発生した。
イベントログにて、以下のような内容が出力されている
ProviderName : Microsoft-Windows-Immersive-Shell Id : 5973 Message : アプリ Microsoft.Windows.Apprep.ChxApp_cw5n1h2txyewy:App.AppXc99k5qnnsvxj5szemm7fp3g7y08we5vm.mca のライセンス認証がエラーで失敗しました: このアプリは、ビルトイン Administrator ではアクティブ化できません。。詳しくは、Microsoft-Windows-TWinUI/Operational ログをご覧ください。 ググっては見たが、
https://support.microsoft.com/ja-jp/help/3064045/windows-store-apps-may-not-open-and-event-id-5973-is-logged-in-the-app
のように、ストアアプリを開くときの権限の問題しかヒットしない。 エクスプローラーからダブルクリックしているのだが、ひょっとしてストアアプリ起動と認識されてしまっているのかも、と思いコマンドプロンプトで起動したところ正常に起動した。
Windows 2016の不具合なのだろうか?</description>
    </item>
    
    <item>
      <title>thinクライアントとして使える古いPCの限界</title>
      <link>https://blog.tack41.net/posts/2018/05/03_01/</link>
      <pubDate>Thu, 03 May 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/05/03_01/</guid>
      <description>手元に、使わなくなったノートPCが2台あったため、Windowsにリモート接続するthinクライアントとして利用してみた。 1台はメモリ512MB, もう一台は768MBでPAE非対応というところからスペックはお察し&amp;hellip;
Linuxを探したのだが、2018/5現在、PAE非対応という時点でインストールできるディストリビューションはかなり限られる。 2,3年前はOKだったLubuntu,XubuntuですらNG。 PuppyLinuxは日本語サイトは情報が古かったため本家を見たが、PAEまたはUEFI必須のようだ&amp;hellip; 今回はKona LinuxのLightをインストールした。
時間はかかったがインストールは成功、最初からRemminaがインストールされていたためRDP接続もできた。 &amp;hellip;が、遅い。キーボードの入力が画面に反映されるのにワンテンポ、タイミングによっては数秒遅れるため、作業が止まってしまう。 さすがに、この程度のスペックでは、Thinクライアントにはスペック不足ということのようだ。10年前にはストレスなく動作したはずなので、kernelが重くなったのか、Remminaが軽くないのか、RDPの通信量がそもそも少なくないのか&amp;hellip;
少なくともメモリは2GB、CPUは2つ以上、要は無印のKona Linuxがインストールできるくらいのスペックがないと再利用すらできないことを実感した。</description>
    </item>
    
    <item>
      <title>GitBookでフッターを変更する方法、目次にページ数を記載する方法がわからない</title>
      <link>https://blog.tack41.net/posts/2018/04/17_01/</link>
      <pubDate>Tue, 17 Apr 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/04/17_01/</guid>
      <description>最近、マニュアル等を単体ではmarkdown、複数文書をまとめる必要がある場合はGitBookで作成している。
GitBookで出版、のような記事も見受けられるため、かなりのことができるのかと思っていたのだが、タイトルにある以下の2件がどうしても解決できない
 フッターのカスタマイズ([現ページ]/[総ページ数]のような表示) 目次でページ数を表示  1点目は、book.jsonにカスタマイズを加える方法、
https://qiita.com/nutti/items/96e7194c82b8d04382e2
及び、_layouts/ebook/pdf_footer.htmlを作成する方法
https://github.com/GitbookIO/gitbook/issues/1661
いずれもフッターは変更できなかった。
2点目は、ページ数が表示されてほしいところになぜか1.1のような表示がされてしまい、GitHubで掲載されている、表示自体を消す方法しか見つからなかった。
https://github.com/GitbookIO/gitbook/issues/1223</description>
    </item>
    
    <item>
      <title>Windows 2016のWindows Update</title>
      <link>https://blog.tack41.net/posts/2018/03/16_01/</link>
      <pubDate>Fri, 16 Mar 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/03/16_01/</guid>
      <description>今年に入って稼働を始めたWindows Server 2016で、原因不明の再起動が発生。 Hyper-Vホストでも発生するため、ゲストOSが未起動の状態で朝を迎え、利用者から問い合わせを受けていた。
原因はタイトルの通り。 信じられないのだが、Windows 2016ではどのように設定しても一度Windows Updateを動かすとactive hourの後で勝手に再起動するらしい&amp;hellip;
https://social.technet.microsoft.com/Forums/Lync/en-US/d6cde72c-80a5-418b-9a49-8a604e35d41b/windows-server-2016-automatically-restart?forum=ws2016
上記記事の最後に、荒っぽいタスクを30分おきに起動して再起動を止める、というworkaroundが紹介されていた。
Command: schtasks Arguments: /change /tn \Microsoft\Windows\UpdateOrchestrator\Reboot /DISABLE うちはそれほど社員数もおらず、夜間にサーバー使えないと困るという人はいないので再起動は止めず、再起動後にゲストOSを自動起動するよう設定した。 併せて、以下の記事を参考に再起動後にメール、LINE通知するようにした。
http://kokura.hatenadiary.jp/entry/2018/02/01/145500
改めて、Windows奥が深い</description>
    </item>
    
    <item>
      <title>特定PCから特定サーバのみホスト名でUNCアクセスできない</title>
      <link>https://blog.tack41.net/posts/2018/03/12_01/</link>
      <pubDate>Mon, 12 Mar 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/03/12_01/</guid>
      <description>社内情シスには常について回る、ファイルサーバーアクセスできない問題。 私も過去何度も経験しているし、WINS, SMBなどの知識もあるのでそんなに悩むことはここのところありませんでした。
しかし、今回は様子が異なり、以下のような症状。
 \\SVRNAME でアクセスできない。 \\SVRNAME.domain.name のようなFQDNでもダメ 他のサーバに対しての\\SVRNAME2 のアクセスは可能。ダメなのは1台のサーバのみ(?) ping SVRNAME は通る(!?) \\IPアドレス であれば該当のサーバでもアクセスできる NetBIOS over TCP/IPは有効になっている %WINDIR%\system32\drivers\etc にあるhosts, lmhosts にエントリはない  上から見ていって、1,2番目まではよくあるNetBIOSの名前解決エラーかと思ったのだが、3,4番目あたりからどうも様子が違う&amp;hellip;
結果は、Windowsのコンパネ-[ユーザーアカウント]-[資格情報マネージャ]に、サーバー名で認証情報が登録されており、指定されたアカウントが無効となっていたため。 こんなところで指定しなくてもADログインすれば自動で認証するので、登録情報を削除したところアクセス可能となった。
Windows は奥が深い #いい意味ではない</description>
    </item>
    
    <item>
      <title>COM経由でのExcel操作は地獄?</title>
      <link>https://blog.tack41.net/posts/2018/02/24_01/</link>
      <pubDate>Sat, 24 Feb 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/02/24_01/</guid>
      <description>VBAでExcelを操作するプログラムをC#に移行。 印刷に使用するActiveXオブジェクトを含む雛形ファイルを対象とするため、Managedな操作をするClosedXMLやNPOIではうまく動作せず、Interop.Excel経由で行った。
ClosedXML等と比較して圧倒的に動作が遅いのは当然として、シートをある程度(10枚以上?)コピーするとtmpファイルを書き込めない旨のエラーが発生する。 タイミングは実施するたびに違い、運が良ければエラーが発生しないこともある。
同様のエラーを探したが、結論としてはエラー時にリトライする処理を追加するくらいしかないらしい&amp;hellip;
https://answers.microsoft.com/ja-jp/msoffice/forum/msoffice_excel-mso_winother-mso_2010/vba%E3%81%A7%E3%82%B7%E3%83%BC%E3%83%88%E3%82%B3/b8b84a3e-d1f8-48a5-8623-04023c8510e8
こういった対処方法は、仕方ないとしても凹みますね。 機会があればネックとなっているActiveXオブジェクトをManagedな操作で置き換えていきたい。</description>
    </item>
    
    <item>
      <title>AccessにOleDbアクセス時、日付型のパラメータを使用する場合は型を明示する必要あり</title>
      <link>https://blog.tack41.net/posts/2018/02/20_01/</link>
      <pubDate>Tue, 20 Feb 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/02/20_01/</guid>
      <description>はまった&amp;hellip; Accessのときのみ発生。
Parameterを使う際、通常、設定した値の型からよきにはからって処理してくれるが、AccessでDateTime、特に時刻部分が設定されている場合ではエラーとなる。
http://yan-note.blogspot.jp/2008/08/systemdatacommondbparameteraccessdate.html</description>
    </item>
    
    <item>
      <title>C#でのDbTransaction.Rollback</title>
      <link>https://blog.tack41.net/posts/2018/02/02_01/</link>
      <pubDate>Fri, 02 Feb 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/02/02_01/</guid>
      <description>C#のTransactionにて、DbTransactionをusing句で使えば、Disposeの際にRollbackされるので、明示的なRollbackが不要とあったのだが、どうもそのように記載しているサイトのほうが少ないように見える。
MSDNで確認したところ、そうあるべきではるが、ベンダー依存のため前提とするのはだめらしい。
Dispose should rollback the transaction. However, the behavior of Dispose is provider specific, and should not replace calling Rollback. https://msdn.microsoft.com/ja-jp/library/bf2cw321(v=vs.110).aspx
SqlTransactionだけならいいかもしれないが、OleDb(Access)やMySQLも共通化している今のコードでは駄目なようだ。try catch使うしかない。
https://msdn.microsoft.com/ja-jp/library/system.data.idbtransaction.rollback(v=vs.110).aspx</description>
    </item>
    
    <item>
      <title>iPad(9.7)でMicrosoft Remote Desktop使用時の注意事項</title>
      <link>https://blog.tack41.net/posts/2018/01/27_01/</link>
      <pubDate>Sat, 27 Jan 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/01/27_01/</guid>
      <description>会社で支給されたiPad Pro 9.7inchで、Microsoft Remote Desktopを利用してWindows 10にアクセスしたところ、その後Windows10にローカルアクセスした際に英語キーボードの設定になっていた。
iPad Pro 9.7inchはSmartKeyboardを使用していて、英語キーボードしかないモデル。おそらくこの設定をMicrosoft Remote Desktopが設定してくれたのだろう。 賢いと言えば賢いのだが&amp;hellip;
Windows 10の設定を見ても日本語キーボードとなっている。一旦英語キーボードに変えようとするとサインアウトを促されるので、キーボードレイアウトの変更はサインアウトをしないと反映されないのだろう。 今回も一旦再起動することで日本語キーボードに戻った。</description>
    </item>
    
    <item>
      <title>redmineのwikiにおけるhtmlのサポート</title>
      <link>https://blog.tack41.net/posts/2018/01/25_01/</link>
      <pubDate>Thu, 25 Jan 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/01/25_01/</guid>
      <description>redmineで、markdown形式を使っていると、文字に色を付ける方法がない。 セキュリティの観点から、あえてすべてのhtmlタグをフィルタしているようだ&amp;hellip;
http://www.redmine.org/issues/20497
社内で運用している場合にセキュリティを気にして表現力が落ちてもしょうがないので、管理画面で切り替えるなどできるといいのだが&amp;hellip; 以下のサイトを参考に設定ファイルを直接書き換え、利用できるようになった。
http://redmine.jp/faq/wiki/use-html-tag-in-wiki/</description>
    </item>
    
    <item>
      <title>DockerのHostの設定変更のcontainerへの反映</title>
      <link>https://blog.tack41.net/posts/2018/01/21_02/</link>
      <pubDate>Sun, 21 Jan 2018 01:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/01/21_02/</guid>
      <description>Host側でのresolv.confを変更したのだが、containerには、docker-compose restartやstop -&amp;gt; startでは反映されない。 一度downしてからupする必要がある。</description>
    </item>
    
    <item>
      <title>AccessでのYes/No型を外部結合してGroupByすると「カレントレコードがありません」</title>
      <link>https://blog.tack41.net/posts/2018/01/21_01/</link>
      <pubDate>Sun, 21 Jan 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/01/21_01/</guid>
      <description>タイトルの通り。
Accessで、OLEDB経由でもAccessで直接クエリをたたいても「カレントレコードがありません」と表示されるエラーに遭遇し、SQLを切り分けたところ、Yes/No型のフィールドが原因と判明。 ググってみると、Yes/No型を外部結合してGroupByすると、Nullが発生した場合に処理できず、このようなエラーが出るらしい。
https://www.pcreview.co.uk/threads/no-current-record-error-in-group-by-query-with-outer-joins-solution.2126293/
対処法は、リンク先にある通り、SELECT、GROUP BYの双方をNzでNullの場合の値を指定すること。
OLEDB接続の場合はNz関数が利用できないので、IIfとIsNullを組み合わせる。
Access嫌だ&amp;hellip;</description>
    </item>
    
    <item>
      <title>RTX1200でL2TP,IPSECによるVPN接続</title>
      <link>https://blog.tack41.net/posts/2018/01/14_01/</link>
      <pubDate>Sun, 14 Jan 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/01/14_01/</guid>
      <description>RTX1200でL2TP,IPSECによるVPN接続を行った。
iOS11(iPhone 7, iPad Pro 1st)では問題なく接続できるのだが、Android, Windows, Linux(Ubuntu)はことごとくダメだった。Windowsはそもそも保証対象外と明記されているらしいのだが、iOSがつながるのならAndroidもつながっても良いと思うのだが&amp;hellip;
Ubuntuの事例として、あわしろさんの記事を見つけたので、これを参考に再チャレンジしようと思う。</description>
    </item>
    
    <item>
      <title>iPhoneのすばらしさに気づく(いまさら)</title>
      <link>https://blog.tack41.net/posts/2018/01/11_01/</link>
      <pubDate>Thu, 11 Jan 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/01/11_01/</guid>
      <description>今日は有給をとって近くをドライブした。 Web+DBでYahooマップの記事があったので、ナビを使ってみようと思ったのだ。
そもそもにしてYahooマップとYahooナビは別アプリなのだが&amp;hellip;
手持ちのNexus5Xで試した。アプリの機能としては問題ないと思うのだが&amp;hellip; それよりもバッテリーのヘリが気になってしまう。充電しながら使っているのだが、それでも2,30分で10%は減る。これでは、そもそも長距離ドライブには使えない。ナビなんて長距離でしか使わないのに&amp;hellip;
で、会社で支給されているiPhone7にGoogle Mapを入れてナビを使ってみたところ、充電中は電池が減らないどころか、少しずつ充電されてる!!! iPhone使ってる人や、バッテリの持ちの良いAndroid使ってる人なら当然かもしれないが、その世界を知らない僕はふつうに驚いた。
やはり、Androidスマホと比較するとiPhoneは素晴らしいと。今回はバッテリーでその点に気付いたが、社内のスマホに関する障害の問い合わせもiPhoneよりAndroidの方が圧倒的に多い。
それも当然で、AndroidとiPhoneでは1機種にかける開発・保守費用が全然違う。Androidの代表としてGoogleのPixelを参照したとしても1桁どころか2,3桁は違うのではないだろうか。 ソフトウェアと違ってハードウェアはかけた金額が性能により効いてくると思う。正直Appleにばかり儲けさせるのは気に食わないという気持ちもあるが、価格以上の性能、信頼性があるのだと実感する。 この構造は、独禁法などで介入でもされない限り今後も当面変わらないのではないか。
今後は、Androidでしかないアプリがあるとか、ハードも含めてガンガンいじって開発したいとかでなければiPhoneを薦めたいと思う。公私ともに。 自分はAndroidが好きなので使うが、割り切って安いモデルを2年間使い倒すのが、今のAndroidには合っていると思われる。iPhoneのように長く使うには向いていない。</description>
    </item>
    
    <item>
      <title>zabbix share のtemplteは素晴らしい</title>
      <link>https://blog.tack41.net/posts/2018/01/10_01/</link>
      <pubDate>Wed, 10 Jan 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/01/10_01/</guid>
      <description>社内にて、NAS(Buffalo Terastation)、UPS(APC)の切替を行った。 社内の機器の監視はzabbixで行っており、これらの設定をする際、Zabbix Share のテンプレートが使えたのは非常にありがたかった。
Terastationは3.2用のテンプレートだったが、社内では3.0を運用しているためバージョンの指定を変更後、mokeblogさんのエントリを参考に不要なタグを削除してインポートした。 APCは2.0用だったが、バージョンの指定を変更するだけでインポートできた。(電圧上限、下弦の閾値は200V前提となっていたため、下限:190-&amp;gt;90,上限250-&amp;gt;120に修正した)
これらのSNMP MIBを調べて設定するのは時間がかかるので、こういうのが公開されているのは時間がない管理者としてはありがたい。細かいところを自社に合わせて修正して利用しようと思う。</description>
    </item>
    
    <item>
      <title>ファイルサーバーの移行</title>
      <link>https://blog.tack41.net/posts/2018/01/08_01/</link>
      <pubDate>Mon, 08 Jan 2018 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2018/01/08_01/</guid>
      <description>以下の要件で、ファイルサーバーの移行を行った。
 移行元サーバー: Windows Server 2008 R2 (Enterprise) 移行先サーバー: Windows Server 2016 (Standard) 移行容量: 150GB程度 移行に使用した方法: Windows Server移行ツール  結果は、権限はNTFS、共有のものも含めて完璧に移行できた。移行後は既に公開設定が済んだ状態となっていた。 時間は8時間ちょっとかかった。複数の対象フォルダがあったため、Powershellでのバッチを作成して両方で動作させたため、つきっきりだったわけではない。
移行は2段階で行い、最初に10GBほどのフォルダの移行を行った。この移行では暗号化を行うのだが、これによるCPUの負荷が大きいことに気付き、2段階目ではCPUを2-&amp;gt;4に増強した(共にHyper-V上のVM)。 2段階目において、Trend Micro Business Securityのスキャンが開始されたことに気付いたのだが、管理者権限で停止しようとしても受け付けてもらえず、結局アンインストールすることで停止するしかなかった。その間1.5時間ほどメモリ、ディスクIOがかなり高い状態だった。
上記の問題がなかったとしても6-7時間はかかったと思われる。容量に対してあまりに時間がかかりすぎている。同ツールでは移行後に権限だけ付け直す「-Include Share」オプションがあるようなので、robocopyでファイルだけ移行し、「-Include Share」オプションで権限を移行する方法が最も時間をかけずに確実に移行できたのではないかと思う。</description>
    </item>
    
    <item>
      <title>テーブル定義の移行でよく使う方法</title>
      <link>https://blog.tack41.net/posts/2017/11/30_01/</link>
      <pubDate>Thu, 30 Nov 2017 10:51:34 +0000</pubDate>
      
      <guid>https://blog.tack41.net/posts/2017/11/30_01/</guid>
      <description>社内DBを試行錯誤しているため、DB間データ移行の前段としてテーブル定義をコピーしたいことがある。 大抵のDBでは無料でもツールが充実しており、ODBCライブラリを入れればよっぽど問題ないと思うのだが&amp;hellip;
 MySQL &amp;hellip; Workbench Oracle &amp;hellip; SQL Developer SQL Server &amp;hellip; SQL Server Management Studio(SSMS)  Windows 10 Pro 64bitで、SSMSからOracleにアクセスしようとしたところ、どうにもエラーでうまく行かない。64bitのInstant Client + ODBCをインストールし、OSのODBC管理ツールでテスト接続は成功しているのだが&amp;hellip;
で、こういう時はAccessでODBC経由でリンクを貼る分にはまず失敗しない。この状態でテーブルをAccessにテーブル定義のみコピーし、そのAccessのテーブルをSSMSでインポートするとうまくいく。</description>
    </item>
    
    <item>
      <title>redmine, zabbixのActive Directory(LDAP)認証</title>
      <link>https://blog.tack41.net/posts/2017/11/24_01/</link>
      <pubDate>Fri, 24 Nov 2017 13:11:09 +0000</pubDate>
      
      <guid>https://blog.tack41.net/posts/2017/11/24_01/</guid>
      <description>redmine, zabbix共にActive DirectoryのLDAP機能を利用して認証の統合ができる。が、設定方法が引っかかった。
redmineはアカウントごとに認証方式の設定が可能。「管理」の「LDAP認証」にAD認証の設定をしたうえで、AD認証したいアカウントを作成して認証方法をADと指定してやればよい。
一方、zabbixは認証方法を変えるとそれが全ユーザーに適用される。ユーザーグループごとに認証方式が指定できるのだが、既定では「デフォルト」となっている。 認証を変えると、この「デフォルト」の認証方式が変わるので、結果として全ユーザーグループの認証方式が変更されてしまう。なので、「Zabbix administrators」グループの認証方式を事前にローカルに変更しておく必要がある。
だが、インストール時に作成される管理者アカウントでログインした状態だと、この「Zabbix administrators」グループの認証方式を変更できない。自分、及び自分のプライマリグループに関する情報は変更できないらしい。なので、別のユーザーグループを作成し、そこに所属するアカウントを作成。アカウントに「Zabbix特権管理者」権限を付与。そのアカウントでログインして「Zabbix administrators」グループの認証方式を「Zabbixデータベース内のユーザー情報」に変更する、という手順を踏む必要がある。 zabbixめんどい。</description>
    </item>
    
    <item>
      <title>ClosedXMLの画像追加におけるWorksheetの取り扱いについて</title>
      <link>https://blog.tack41.net/posts/2017/11/07_01/</link>
      <pubDate>Tue, 07 Nov 2017 10:20:41 +0000</pubDate>
      
      <guid>https://blog.tack41.net/posts/2017/11/07_01/</guid>
      <description>C#でClosedXMLを使用してExcelに画像を追加する処理をしていた際、なぜかWorkbookの保存時にObjectDisposedExceptionが発生するという事態になりました。
以下のようなコードです
 using (XLWorkbook wb = new XLWorkbook(filePath))  {  IXLWorksheet ws_src = wb.Worksheet(&amp;#34;Template&amp;#34;);   using (IXLWorksheet ws = ws_src.CopyTo(&amp;#34;1&amp;#34;))  {  var image = ws.AddPicture(imagePath1);  image.MoveTo(ws.Cell(3, 3).Address);  image.Scale(.5);   image = ws.AddPicture(imagePath2);  image.MoveTo(ws.Cell(20, 3).Address);  image.Scale(2);   }   using (IXLWorksheet ws = ws_src.CopyTo(&amp;#34;2&amp;#34;))  {  var image = ws.AddPicture(imagePath3);  image.MoveTo(ws.Cell(3, 3).Address);  image.Scale(.5);  }   ws_src.</description>
    </item>
    
    <item>
      <title>MySQL Workbenchに切り替え</title>
      <link>https://blog.tack41.net/posts/2017/10/19_02/</link>
      <pubDate>Thu, 19 Oct 2017 19:18:47 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2017/10/19_02/</guid>
      <description>前回の記事で、HeidiSQLがうまく動作しない(DEFAULT CURRENT_TIMESTAMPを表示できない)件で、クライアントをMySQL Workbenchに切り替えた。
実は以前も試していたのだが、ホスト名のみで指定した場合に、Test Connectionは成功するのに実際に接続する際にエラーで落ちてしまっていて中止していた。IPアドレスで指定したところ正常に動作したので、こちらに切り替えることにした。</description>
    </item>
    
    <item>
      <title>HeidiSQLがDEFAULT CURRENT句を認識しない</title>
      <link>https://blog.tack41.net/posts/2017/10/19_01/</link>
      <pubDate>Thu, 19 Oct 2017 16:45:52 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2017/10/19_01/</guid>
      <description>社内データベースをMariaDBで構築しており、Windows 10からHeidiSQLにてアクセスしているのだが、TIMESTAMP型の列にDEFAULT CURRENT_TIMESTAMP を設定すると、更新は成功するのだが、画面上表示されない。コメントまで表示されなくなる。
値が設定されていないわけではなく、
show full columns from テーブル名 で確認するとちゃんと設定されているので、別画面で確認しながら進めないといけない。めんどい。
 OS: Windows Server 2008 R2 SP1 MariaDB: 10.2.9 HeidiSQL: 9.4.0.5125  本家のForumを見ると、2件同様の報告が上がっているが、コメントがついていない。 別のツールに切り替えるか。</description>
    </item>
    
    <item>
      <title>.Netプログラムの配布</title>
      <link>https://blog.tack41.net/posts/2017/10/12_01/</link>
      <pubDate>Thu, 12 Oct 2017 17:52:37 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2017/10/12_01/</guid>
      <description>今さら、とは思われるとは思いますが&amp;hellip;
当社の社内システムは、外部業者に保守を依頼している販売管理システムとパッケージの会計システムを除いて、はほぼAccessでした。データもファイルに含んでいるタイプ。 なので、各自ファイルをデスクトップにコピーするとデータが共有できなくなるので、ファイルサーバにファイルを置いて、各自が直接実行する形で利用していました。たまに動作がおかしくなったのは、同時起動でファイルが壊れたりしたのではないかと思ってます。
現在、社内システムをC# + RDBMS(SQL Server, MariaDB)に移行中。 上記の感覚で、C#のプログラムは、dllも含めてファイルサーバに置いて、各自直接実行してもらってました。さすがに動作がおかしくなることはないのですが、dllも含めて手動で配置しないといけないとか、ファイルサーバの場所を忘れると実行できないとか、いまいちだな～と思ってました。
そう、ClickOnce。 プロジェクトの設定にて「発行」の項目でファイルサーバを指定して発行すれば、インストーラが生成され、それをインストールしてもらえば以降はスタートメニューから起動可能。バージョンアップ時の更新も勝手に検知してやってくれる。最高!!
10年遅れ? でMicrosoftさんの素晴らしさを実感しました。</description>
    </item>
    
    <item>
      <title>MariaDBからSQL Serverを直接参照するテーブルを作成</title>
      <link>https://blog.tack41.net/posts/2017/10/10_01/</link>
      <pubDate>Tue, 10 Oct 2017 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2017/10/10_01/</guid>
      <description>概要 Windows上のMariaDBからSQL Serverを直接参照するテーブルを作成します。Accessのリンクテーブル。 Connect Storageという機能を利用します。
経緯 社内データの保管に、以下の理由でSQL Serverを利用していました。
 ODBCを設定せずにExcelから参照できる。 Windows認証を利用できるので、アプリで認証を考慮する必要がない。  後者に関しては、エラー時の対応等、逆にややこしくなりそうでメリットにならないと判断。ただ、前者を利用した、簡易BIとしてのExcelピボットテーブルファイルが利用されているため、うまく対応する必要がありました。
将来性を考えると、10GBに制限されるSQL Server Express Editionは避けたいところ。そこで、まずMariaDBサーバを立ててSQL Serverのデータを参照する形で運用を開始することにしました。
MariaDBには、異種データベースを参照するConnect Storage Engineという機能があることが分かり、これを利用して実装しました。
前提  OS: Windows Server 2008 R2 Maria DB: 10.2.9 SQL Server: SQL Server 2008 R2 Express Edition  データベース名: DBTEST DBユーザー名: USERTEST, パスワード: PASSTEST テーブル名: TABLETEST    手順   管理ツールの「データソース(ODBC)」にて、SQL ServerへのDSNを登録(DSN名を「SQLSVR」とする)
  MariaDBにmysqlクライアントで接続し、以下のコマンドでConnect Storage Engineを有効化する。
INSTALL SONAME &amp;#39;ha_connect&amp;#39;   以下のコマンドでConnect Storage Engine経由での参照を利用したテーブルエントリを作成する。
CREATE TABLE TABLETEST ENGINE=CONNECT DEFAULT CHARSET=cp932 TABLE_TYPE=ODBC CONNECTION=&amp;#39;DSN=SQLSVR;UID=USERTEST;PWD=PASSTEST&amp;#39;;   問題点 上記手順だと、該当のデータベースの一覧(show tables)まではできるが、内容を取得(select * from &amp;hellip;)できない。 SELECTしか必要ない場合においても、全データベースに対する全操作の権限(grant all on .</description>
    </item>
    
    <item>
      <title>Dockerでstorageにoverlayを使う際の注意事項(2016/2時点,CentOS7)</title>
      <link>https://blog.tack41.net/posts/2016/02/09_02/</link>
      <pubDate>Tue, 09 Feb 2016 02:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2016/02/09_02/</guid>
      <description>Dockerでstorage driverにoverlayを使ってはまったこと。
2016/2時点 CentOS7でのdocker(1.8.2)においては、コンテナのファイルが2GBを超えると、読み込めなくなるようだ。
mariadbにて、dumpファイルの取り込みまでは問題ないのだが、これを一旦停止し、再度立ち上げようとすると「27: File too large」というメッセージが出て起動できない。 ググってみたところ、どうもこのメッセージはMariaDBというよりもOSが出しているようだ。そのことに気づいてoverlayをdevicemapperに戻したところ、現象は発生しなくなった。
開発者サイドでも、まだoverlayは何が起こるかわからない、というスタンスらしいので、要注意。</description>
    </item>
    
    <item>
      <title>Dockerでのmysql利用時の注意</title>
      <link>https://blog.tack41.net/posts/2016/02/09_01/</link>
      <pubDate>Tue, 09 Feb 2016 01:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2016/02/09_01/</guid>
      <description>Dockerでmysqlを利用する際にはまったこと。
Dockerfile等で初期データを流し込みたい場合、mysqld_safeを「バックグラウンド」で起動しておいてmysqlコマンドで流しこみを行うのだが、
nohup mysqld_safe &amp;amp; mysql -u root &amp;lt; init.sql のように実行してしまうと、 mysqlサーバが起動する前にコマンドが帰ってきてしまうため2行目で「mysql.sockがない」という旨のエラーが返ってきてしまう。
このような場合、1行目の後に以下のようなループを噛ませるとうまく行くはず。(bashの場合)
nohup mysqld_safe &amp;amp; for {1..10}; do if [ -e /var/lib/mysql/mysql.sock ]; then break fi sleep 1 done </description>
    </item>
    
    <item>
      <title>VPSのCentOS7にRails環境構築</title>
      <link>https://blog.tack41.net/posts/2015/08/09_01/</link>
      <pubDate>Sun, 09 Aug 2015 00:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2015/08/09_01/</guid>
      <description>さくらのVPS上にCentOS7.0でRails環境を構築したのでそのメモ。 一般ユーザーにて、必要に応じてsudoをかませて実行。
 ユーティリティプログラムをインストール git clone https://github.com/sstephenson/rbenv.git ~/.rbenv git clone https://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build echo &amp;#39;export PATH=&amp;#34;$HOME/.rbenv/bin:$PATH&amp;#34;&amp;#39; &amp;gt;&amp;gt; ~/.bash_profile echo &amp;#39;eval &amp;#34;$(rbenv init -)&amp;#34;&amp;#39; &amp;gt;&amp;gt; ~/.bash_profile exec $SHELL  必要なパッケージのインストール $ sudo yum install libffi-devel zlib zlib-devel openssl openssl-devel readline-devel sqlite-devel  ruby 2.2.0をインストール rbenv install 2.2.0 rbenv global 2.2.0  railsをインストール gem update --system gem install --no-ri --no-rdoc rails gem install bundler rbenv rehash rails -v  動作確認 rails s -b 0.</description>
    </item>
    
    <item>
      <title>ESXi 5.1.0上でWin2012 Hyper-Vがインストールできない</title>
      <link>https://blog.tack41.net/posts/2013/05/06_01/</link>
      <pubDate>Mon, 06 May 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.tack41.net/posts/2013/05/06_01/</guid>
      <description>VMware ESXi .5.1.0上で検証目的のためにWindows 2012 StandardをインストールしてHyper-Vの役割を追加しようとすると「すでにインストールされています」と表示されてしまう。VMware Toolsをアンインストールしてもだめ。
そういうもんなんかなぁ。
ESXi on VMware Playerは昔動いた記憶があるんだけど、Hyper-V on ESXiは無理なのか?</description>
    </item>
    
    <item>
      <title>FreeNAS8.3.1でiSCSI target</title>
      <link>https://blog.tack41.net/posts/2013/05/04_01/</link>
      <pubDate>Sat, 04 May 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.tack41.net/posts/2013/05/04_01/</guid>
      <description>オープンソースでiSCSIターゲットを実装可能なFreeNASを利用し、Windows 2012より利用する。
1. 初期設定  FreeNAS 8.3.1のインストール  CPU: i5 2405S 1c MEM: 1GB Disk1: 30GB(OS Install) Disk2 :10GB(iSCSI Volume)   CUIにてNWアドレスを設定  2. iSCSI targetの設定  WebUIにてアクセス ボリュームの追加  [Volume]-[Volume Manager]にてボリュームを追加する。 上段[Servies]-[Core]にてiSCSIをオンにする
   iSCSIポータルの設定
[iSCSI]-[ポータル]を選択し、アクセス制限を設定する(ここではオールOKとした)
 Initiatorの許可
[iSCSI]-[Initiator]で接続元のInitiatorを制限する(下図では制限なし)
 ポータルの追加
[iSCSI]-[Portal]を選択し、ポータルを追加する(下図では全アクセスを許可)
 Initiatorの設定
[iSCSI]-[Initiators]よりInitiatorのアクセス制限をかける。下図では制限なし。  ターゲットの追加
[iSCSI]-[Targets]を開き、[Add Target]ボタンをクリック
すべて入力して[OK]をクリック。 ターゲットにエクステントを追加
[iSCSI]-[Associated Targets]を開き、[Add Extend to Target]をクリックする
これまで入力した内容を入力する
 WindowsやLinuxのiSCSI initiatorから接続できることを確認。  </description>
    </item>
    
    <item>
      <title>Windows Server 2012でiSCSI target (2)initiator側</title>
      <link>https://blog.tack41.net/posts/2013/04/19_02/</link>
      <pubDate>Fri, 19 Apr 2013 02:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2013/04/19_02/</guid>
      <description> [管理ツール]-[iSCSIイニシエーター]を起動 初回はサービス起動確認のダイアログが表示されるので[はい]をクリック
 [ターゲット]にiSCSI TargetサーバのIPアドレスを入力して[クイック接続]をクリック
 Targetが認識されているのを確認し、[完了]をクリックする。
 [ディスクの管理]にて作成したディスクが認識されていることを確認する。
  </description>
    </item>
    
    <item>
      <title>Windows Server 2012でiSCSI target (1)target側</title>
      <link>https://blog.tack41.net/posts/2013/04/19_01/</link>
      <pubDate>Fri, 19 Apr 2013 01:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2013/04/19_01/</guid>
      <description>iSCSI target, initiator共にWindows Server 2012(Full)
[iSCSI target]
 [ローカルサーバー]-[管理]-[役割と機能の追加]を選択
 [次へ]をクリック
 [役割ベースまたは機能ベースのインストール]を選択
 自身のサーバを選択
 [ファイルサービスおよび記憶域サービス]-[ファイルサービスおよびiSCSIサービス]-[iSCSIターゲットサーバー]、[iSCSIターゲット記憶域プロバイダー]を選択
 機能は追加せずに[次へ]をクリック
 [インストール]を選択
 [閉じる]を選択
 サーバマネージャーに戻り、[ファイルサービスと記憶域…]を選択
 [iSCSI]を選択
 [タスク]-[新しいiSCSI仮想ディスク]を選択
 ディスクを作成するボリュームを選択し、「次へ」をクリック。
 適当な名前を入力し、次へをクリック
 割り当て容量を入力し、次へをクリック
 [新しいiSCSIターゲット]を選択
 適当な名前を入力し、[次へ]をクリック。
 [追加]をクリック
 iSCSI initiatorの情報を入力
 必要に応じてCHAP, リバースCHAPを有効にする
 [作成]をクリックして完了する
 正常に作成されたのを確認し、[閉じる]をクリック。
  </description>
    </item>
    
    <item>
      <title>FreeNAS(8.3.0)にてCIFS設定</title>
      <link>https://blog.tack41.net/posts/2012/12/11_01/</link>
      <pubDate>Tue, 11 Dec 2012 00:00:00 +0000</pubDate>
      
      <guid>https://blog.tack41.net/posts/2012/12/11_01/</guid>
      <description>任意のユーザーにアクセス許可を与える場合  CDにてインストール 初回起動後、コンソールにてIPアドレス、DNSを設定 Webコンソールにて[Storage]-[Active Volumes]-[Volume Manager]を選択
 対象のボリュームを選択し、必要な情報を入力して[Add Volume]をクリック
 [Storage]にて先ほど作成した「Volume1」にて[Change Permissions]をクリック。
 Owner(user/group)にて適切な所有者を指定する。今回は全ユーザーに許可を与えるためnobodyをOwnerに指定している。
 [Shares]-[Windows(CIFS)]-[Add Windows(CIFS) Share]をクリック。
 必要な情報を入力する。ポイントは以下の通り。  [Path]には前で作成したボリューム(/mnt/Volume1)を入力する。 以下のチェックボックスにチェックを入れる。  Browsable to Network Clients Allow Guests Access Only Allow Guest Access      CIFSサービスを起動するかどうか確認ダイアログが表示されるので、Yesをクリックする。
 [Services]にて[CIFS]が[ON]になっていることを確認し、右にあるスパナのアイコンをクリックする。
 CIFSの各種設定を行う。ポイントは以下の通り。  Authentication Modelは「Local User」を指定する。「Anonymous」を指定するとファイルを作成できるが変更・削除ができなくなる。 DOS charsetは「CP932」を指定。 上記以外はデフォルトのまま
   Explorerにて上記で作成したフォルダが見えることを確認。
 ファイルやフォルダを作成できることを確認。   特定ユーザーにアクセス許可を与える場合 (上記任意のユーザーにアクセス許可を与える作業は実施済みとする)
 [Account]-[Users]-[Add User]にてアクセス許可を与えるユーザーを作成する。 [Shares]-[Windows(CIFS)]にて作成済みの共有フォルダの[Edit]ボタンをクリックする。
 最下部の「Allow Guest Access」「Only Allow Guest Access」のチェックを外して[OK]ボタンをクリックする。</description>
    </item>
    
    <item>
      <title>Ubuntu12.10でHulu</title>
      <link>https://blog.tack41.net/posts/2012/12/03_01/</link>
      <pubDate>Mon, 03 Dec 2012 00:00:00 +0000</pubDate>
      
      <guid>https://blog.tack41.net/posts/2012/12/03_01/</guid>
      <description>Ubuntu12.10 64bitにてHuluの字幕が文字化けする。
ネットで検索してフォント関連をインストールしてみたがうまく行かない。
同様の現象に悩んでいる人もいるようだ…
http://solvedmyquestions.blogspot.jp/2012/11/ubuntu-hulu.html</description>
    </item>
    
    <item>
      <title>Ubuntu 12.10でkvm</title>
      <link>https://blog.tack41.net/posts/2012/12/02_01/</link>
      <pubDate>Sun, 02 Dec 2012 00:00:00 +0000</pubDate>
      
      <guid>https://blog.tack41.net/posts/2012/12/02_01/</guid>
      <description>以下を参照。
http://blog.livedoor.jp/shota_soga_/archives/3527400.html
  sudo apt-get install kvm qemu-kvm libvirt-bin virt-viewer virt-manager sudo modprobe kvm sudo service libvirt-bin start sudo virt-manager sudo virt-manager  引き続き、他のPCと同じNW環境にするためのブリッジ設定。
http://tipspc.blogspot.jp/2011/09/qemu-kvm-ubuntu-debian.html NetworkManagerを削除 sudo apt-get remove network-manager  &amp;ldquo;/etc/network/interfaces&amp;quot;を以下のとおり編集。 auto lo iface lo inet loopback auto eth0 iface eth0 inet manual auto br0 iface br0 inet dhcp bridge_ports eth0 bridge_maxwait 0 bridge_fd 0 bridge_stp off   </description>
    </item>
    
    <item>
      <title>Ubuntu12.10の初期設定</title>
      <link>https://blog.tack41.net/posts/2012/11/29_02/</link>
      <pubDate>Thu, 29 Nov 2012 02:00:00 +0000</pubDate>
      
      <guid>https://blog.tack41.net/posts/2012/11/29_02/</guid>
      <description>下記参照。 http://ubuntuapps.blog67.fc2.com/blog-entry-446.html
ipv6の無効化 /etc/sysctl.confの最終行に以下のコメントを追加
net.ipv6.conf.all.disable_ipv6 = 1 OS再起動
ファイアウォールを有効にし、ssh, vncを許可
sudo ufw enable sudo ufw default DENY sudo ufw allow 22 sudo ufw allow 5900 sudo ufw status </description>
    </item>
    
    <item>
      <title>VMware, Hyper-V, kvm(&#43;VirtualBox)のトリプルブート</title>
      <link>https://blog.tack41.net/posts/2012/11/29_01/</link>
      <pubDate>Thu, 29 Nov 2012 01:00:00 +0000</pubDate>
      
      <guid>https://blog.tack41.net/posts/2012/11/29_01/</guid>
      <description>VMware, Hyper-V, kvm(+VirtualBox)のトリプルブート環境構築時のメモ。 HDD構成は以下を想定、HDDは2TBを使用。
 HDD1: VMware ESXi 5.1 (2TB) HDD2:  Hyper-V Server (1TB) kvm(+Virtual Box) (1TB)    ブートローダは
 USBメモリ-VMware HDD2-grub(Hyper-V/Linux)  通常はUSBメモリよりVMwareをブート。Hyper-V or Linuxブートの際にはUSBメモリを抜き、画面よりどちらかを選択する。
 VMware ESXi 5.1.0をUSBメモリにインストール datastoreにHDD1を追加。当初以下のエラーが表示されていた
これは日本語化によるバグらしく、起動時に「-locale en_US」とつけることで回避可能。
 Hyper-V Server 2012のインストール
ディスクの指定でHDD1の半分程度を指定する。この時点で、  デフォルトでHyper-Vが起動 BIOSにてHDD2を指定するとVMwareが起動
という状態。ただ、Hyper-VにWindows7で管理するための設定が難しく、ブートはするが使用できない状態…   CentOS 6.3のインストール
HDD1の後半の空き領域をインストール先に指定し、デフォルトのブートデバイスとしてHDD2を指定。インストールオプションは「Virtual Host」を指定。
CUIで起動する。VirtualBoxはGUIがないと操作できないので以下のインストールを実施。 yum groupinstall &amp;#34;X Window System&amp;#34; yum groupinstall &amp;#34;Desktop&amp;#34; yum groupinstall &amp;#34;General Purpose Desktop&amp;#34; grubではvmwareに対してはディスクを「(hd1)」と指定する。 Virtual Box
kernel-devel, gccをインストール後、ホームページよりCentOS6用のrppmをダウンロードしてインストール  </description>
    </item>
    
    <item>
      <title>Adempiereインストール</title>
      <link>https://blog.tack41.net/posts/2012/4/01_01/</link>
      <pubDate>Sun, 01 Apr 2012 00:00:00 +0000</pubDate>
      
      <guid>https://blog.tack41.net/posts/2012/4/01_01/</guid>
      <description>CentOS6.2にAdempiereインストール
[前提条件]
 CentOS 6.2(x86_64) JDK1.6.0u31 Adempiere 3.6.0J_CE PostgreSQL管理者 postgres/postgrespw Adempiere用DBユーザ adempiere/adempierepw Adempiereインストールパス /opt/Adempiere3.6.0J_CE/ AdempiereKeystoreインストールパス /opt/Adempiere3.6.0J_CE/keystore Adempiere Keystore パスワード adempierekeypw   CentOS6.2 インストール(Minimal) PostgreSQLインストール yum install postgresql-server  PostgreSQL初期化 service postgresql initdb service postgresql start chkconfig postgresql on  PostgreSQL接続設定 service postgresql stop vi /var/lib/pgsql/data/pg_hba.conf ----- local all all trust host all all 127.0.0.1/32 trust host all all ::1/128 trust ----- vi /var/lib/pgsql/data/postgresql.conf ----- listen_address = &amp;#39;*&amp;#39; port = 5432 ----- service postgresql start  PostgreSQLユーザ設定 psql --u postgres ----- postgres=#ALTER USER postgres encrypted password &amp;#39;postgrespw&amp;#39;; postgres=#CREATE DATABASE adempiere; postgres=#CREATE USER adempiere WITH ENCRYPTED PASSWORD &amp;#39;adempierepw&amp;#39;; postgres=#\q -----  JDKインストール bash jdk-6u31-linux-x64-rpm.</description>
    </item>
    
    <item>
      <title>Androidフォンをひかり電話の子機化、VPN接続で屋外でも家電(いえでん)</title>
      <link>https://blog.tack41.net/posts/2012/1/28_02/</link>
      <pubDate>Sat, 28 Jan 2012 02:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2012/1/28_02/</guid>
      <description>ネットと同時にひかり電話をひいていたこともあり、興味があって手持ちのAndroidフォン(HTC Evo Wimax)を子機化し、さらにVPNで自宅外でも家電をかけられるように設定した。
SIPサーバに接続するネットワークと、PPPoE経由で外部と接続する家庭内ネットワークがどうしても別々となり、VPNで内部に入った際にSIPサーバに接続できない(一般にSIPクライアントはNAT超えができない)のがネックになりそうだったが、以下の記事を参考にこの2つのネットワークを入り口が2つある同一ネットワークとすることで希望を満たすことができた。
http://musemd.at.webry.info/201107/article_1.html
ONUからの線を分岐させるためのハブが別途必要となる。</description>
    </item>
    
    <item>
      <title>Oracle 11g Express EditionをCentOSにインストール</title>
      <link>https://blog.tack41.net/posts/2012/1/28_01/</link>
      <pubDate>Sat, 28 Jan 2012 01:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2012/1/28_01/</guid>
      <description>インストール要件は以下のURLを参照。
http://docs.oracle.com/cd/E17781_01/install.112/e18802/toc.htm#autoId3
CentOS5.2にインストールする(vault.centos.orgより)。
 CentOSインストール  Desktop - GNOME Server Firewall無効 SELinux無効
※swapを2006MB以上確保しないとoracleインストールチェックで弾かれるので注意   更新適用、再起動 yum update reboot  必要なパッケージがインストールされていることを確認 rpm -qa | grep -E &amp;#39;glibc|make|binutils|gcc|libaio&amp;#39;  VMWare Toolsインストール、再起動 Oracleインストール unzip oracle-xe-11.2.0-1.0.x86_64.rpm.zip rpm -ivh oracle-xe-11.2.0-1.0.x86_64.rpm  環境変数設定 cd /u01/app/oracle/product/11.2.0/xe/bin . ./oracle_env.sh bashrcに以下の行を追加 . /u01/app/oracle/product/11.2.0/xe/bin/oracle_env.sh  リモートアクセスを可能にする sqlplus system SQL&amp;gt; EXEC DBMS_XDB.SETLISTENERLOCALACCESS(FALSE);   </description>
    </item>
    
    <item>
      <title>SCOM ワークグループ環境でのエージェントインストール手順</title>
      <link>https://blog.tack41.net/posts/2012/1/09_04/</link>
      <pubDate>Mon, 09 Jan 2012 04:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2012/1/09_04/</guid>
      <description>スタンドアロンルート証明局を立てて行う。 エンタープライズ証明局の場合は、後述の手順が追加で必要となる。
A. Workgroup環境のコンピュータにAgentを登録する手順 &amp;lt;管理サーバー&amp;gt;
 (1)-(a) CA に証明書を要求する。 (2)-(b) 保留中の証明書要求を承認する。 (3)-(c) 証明書を取得する。 (* 4)-(d) 証明書のエクスポート  &amp;lt;エージェントインストール対象のサーバー&amp;gt;
 (5)-(e) 証明書チェーンをインストールする (6)-(f) 信頼されたルート証明書をローカルコンピュータにコピーする (7)-(a) CA に証明書を要求する。 (8)-(b) 保留中の証明書要求を承認する。 (9)-(c) 証明書を取得する。 (10)-(d) 証明書のエクスポート  &amp;lt;管理サーバー&amp;gt;
 (11)-(g) MOMCertImport を使用して証明書をインポートする  &amp;lt;エージェントインストール対象のサーバー&amp;gt;
 (12)-(g) MOMCertImport を使用して証明書をインポートする  (a) CA に証明書を要求する。  証明書をインストールするコンピュータ (管理サーバーやエージェントインストール対象のサーバー) にログオンする。 Internet Explorer を起動し、証明書サービスのホスト コンピュータ (http://&amp;lt;サーバー名&amp;gt;/certsrv など) に接続する。 [Microsoft 証明書サービス] ページで [証明書を要求する] をクリックする。 [証明書の要求] ページで [証明書の要求の詳細設定] をクリックする。 [証明書の要求の詳細設定] ページで [この CA への要求を作成し送信する。] をクリックする。 [証明書の要求の詳細設定] ページで次の処理を行う。  [識別情報] の [名前] フィールドに、証明書の要求対象のコンピュータ(管理サーバーやエージェントインストール対象のサーバー) の完全修飾ドメイン名 (FQDN) を入力します。残りのフィールドに、適切な情報を入力する。</description>
    </item>
    
    <item>
      <title>SCOM クラスタ環境の監視について</title>
      <link>https://blog.tack41.net/posts/2012/1/09_03/</link>
      <pubDate>Mon, 09 Jan 2012 03:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2012/1/09_03/</guid>
      <description>クラスタ環境で仮想ホストの監視を行う場合、エージェントプロキシを有効にする必要がある。
エージェントプロキシを有効にすると、監視対象ホスト一覧に仮想ホストも表示されるようになる。</description>
    </item>
    
    <item>
      <title>SCOM レポートスケジュールのバグ</title>
      <link>https://blog.tack41.net/posts/2012/1/09_02/</link>
      <pubDate>Mon, 09 Jan 2012 02:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2012/1/09_02/</guid>
      <description>SQL Server 2008のバグにより、レポートのスケジュール機能が動作しない場合がある。
Scheduled reports that you create by using SQL Server 2008 Reporting Services (SSRS) do not display chart data in System Center Operations Manager 2007 R2
対策  SQL Server の稼動しているコンピューターに、管理者権限のあるユーザーでログイン エクスプローラで以下のフォルダを開きます。Reporting Services フォルダは、SQL Server Reporting Services のインストールフォルダにある
¥Reporting Services¥ReportServer¥bin 開いたフォルダにある ReportingServicesService.exe.config をコピーし (バックアップ)、メモ帳で開く 下記の内容を、&amp;lt;dependentAssembly&amp;gt; と &amp;lt;/dependentAssembly&amp;gt; に囲まれた部分に追加する &amp;lt;assemblyIdentity name=&amp;#34;Microsoft.ReportingServices.ProcessingCore&amp;#34; publicKeyToken=&amp;#34;89845dcd8080cc91&amp;#34; culture=&amp;#34;neutral&amp;#34; /&amp;gt; &amp;lt;bindingRedirect oldVersion=&amp;#34;9.0.242.0&amp;#34; newVersion=&amp;#34;10.0.0.0&amp;#34; /&amp;gt; &amp;lt;/dependentAssembly&amp;gt; &amp;lt;dependentAssembly xmlns=&amp;#34;urn:schemas-microsoft-com:asm.v1&amp;#34;&amp;gt; &amp;lt;assemblyIdentity name=&amp;#34;Microsoft.ReportingServices.ProcessingCore&amp;#34; publicKeyToken=&amp;#34;89845dcd8080cc91&amp;#34; culture=&amp;#34;neutral&amp;#34; /&amp;gt; &amp;lt;bindingRedirect oldVersion=&amp;#34;9.0.242.0&amp;#34; newVersion=&amp;#34;10.0.0.0&amp;#34; /&amp;gt;  変更を保存して、ファイルを閉じる SQL Server Reporting Services を再起動する  </description>
    </item>
    
    <item>
      <title>SCOM 2007 R2 インストール手順</title>
      <link>https://blog.tack41.net/posts/2012/1/09_01/</link>
      <pubDate>Mon, 09 Jan 2012 01:00:00 +0900</pubDate>
      
      <guid>https://blog.tack41.net/posts/2012/1/09_01/</guid>
      <description>Windows Server 2008 R2 Enterpriseを前提とする。
 ドメイン参加 SQL Server 2008のインストール
Windows Server 2008 R2ではSQL Server 2008をインストールする際はService Pack1移行の適用が必要となるため、以下のURLを参考にスリップストリームインストールを行う。  新規スタンドアロン データベースエンジンサービス, Reporting Services, 管理ツール - 基本, 完全 ネイティブモードの既存の構成をインストールする
※ SQL Server 2008 R2をインストールする場合、SCOMインストール時に下記URLにあるとおり手動作業が必要となる。 http://engineer-memo.com/blogs/engineer-memo/archive/2010/10/27/sql-server-2008-r2-opsmgr.aspx   役割の追加にて「Webサーバ(IIS)」をインストールし、以下のURLにあるとおり、以下の項目を有効にする。
http://support.microsoft.com/kb/973451/ja  [役割サービス] ページで、[HTTP 基本機能] を展開し、以下のチェック ボックスをオンにします。  [静的なコンテンツ] [既定のドキュメント] [ディレクトリの参照] [HTTP エラー] [HTTP リダイレクション]   [アプリケーション開発] を展開し、以下のチェック ボックスをオンにします。  [ASP.NET] [.NET 拡張性] [ASP] [ISAPI 拡張] [ISAPI フィルタ]
注 : 必要な役割サービスを追加するように求めるメッセージが表示されたら、[OK] をクリックします。   [状態と診断] を展開し、以下のチェック ボックスをオンにします。  [HTTP ログ] [要求の監視] [セキュリティ] を展開し、以下のチェック ボックスをオンにします。 [Windows 認証] [要求フィルタ]   [管理ツール] を展開し、以下のチェック ボックスをオンにします。  [IIS 管理コンソール] [IIS 6 管理互換]   さらに [IIS 6 管理互換] を展開し、以下のチェック ボックスをオンにします。  [IIS 6 メタベース互換] [IIS 6 WMI 互換] [IIS 6 スクリプトツール] [IIS 6 管理コンソール]     ASP.</description>
    </item>
    
  </channel>
</rss>
