<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>tech | tack41's blog</title><meta name=keywords content><meta name=description content="tack41's blog"><meta name=author content="tack41"><link rel=canonical href=https://blog.tack41.net/categories/tech/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.tack41.net/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://blog.tack41.net/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://blog.tack41.net/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://blog.tack41.net/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://blog.tack41.net/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://blog.tack41.net/categories/tech/index.xml><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-DNWENV5G0J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-DNWENV5G0J",{anonymize_ip:!1})}</script><meta property="og:title" content="tech"><meta property="og:description" content="tack41's blog"><meta property="og:type" content="website"><meta property="og:url" content="https://blog.tack41.net/categories/tech/"><meta property="og:image" content="https://blog.tack41.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="og:site_name" content="tack41's blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.tack41.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="tech"><meta name=twitter:description content="tack41's blog"></head><body class=list id=top><script>window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.tack41.net/ accesskey=h title="Home (Alt + H)"><img src=https://blog.tack41.net/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://blog.tack41.net/categories/ title=categories><span>categories</span></a></li><li><a href=https://blog.tack41.net/tags/ title=tags><span>tags</span></a></li><li><a href=https://blog.tack41.net title=tack41.net><span>tack41.net</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://blog.tack41.net/>Home</a>&nbsp;»&nbsp;<a href=https://blog.tack41.net/categories/>Categories</a></div><h1>tech</h1></header><article class="post-entry tag-entry"><header class=entry-header><h2>アルファメールプレミアでDBバックアップ</h2></header><div class=entry-content><p>TL;DR アルファメール(プレミア)ではshellの直接実行はできない。が、phpのexecを利用すればほぼ同じことができます。 経緯 自社のWEBサイトを大塚商会のアルファメールプレミアでMovable Typeを利用して運用しています。バックアップに関して、コンテンツファイルはFTP(over TLS)でCLIで取得できますが、DBに関してはphpMyAdminを利用してブラウザからボタンポチポチで取得していました。
WEBコンソールのメニューの中に「cron設定」という項目があるのに気づいて調べたところ、拡張子が「.cgi」または「.php」のファイルの一覧から選んで指定時刻に実行してくれるということのようでした。
こういうバッチ的な利用が可能なのであれば、execでOSコマンドも実行できるのでは、と思ってmysqldump叩いてみたところ実行できました。これはありがたいということで、AWS SDK for PHPのpackaged phar版をダウンロードしてS3へのアップロードまでできました。
注意事項として、認証情報をファイルから取得する場合、そのファイルを含むパスに認証をかけないと危険です。
定期的に実行したいというより、サイトを更新したときに実行できれば良いので、ブラウザで該当のphpファイルを直接呼び出しています。
phpMyAdminから手動でダウンロードしてS3にアップというのは地味に面倒なので、ブラウザ呼び出し一発でできるようになって工数削減できました。</p></div><footer class=entry-footer><span title='2022-03-26 00:00:00 +0900 +0900'>March 26, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;tack41</footer><a class=entry-link aria-label="post link to アルファメールプレミアでDBバックアップ" href=https://blog.tack41.net/posts/2022/03/26_01/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Active Directoryでログイン時にPowershell経由でexeを実行</h2></header><div class=entry-content><p>TL;DR Active Directoryでログイン時にexeファイルを実行する場合はStart-Processでの実行が必要 経緯 Emotetが流行っているので、EmocheckをActive Directory のログインスクリプトに仕込んでみていた。
単体では実行できるので問題ないと考えていたが、どうもActive Directory のグループポリシーでログイン時に起動する設定をすると何故か実行されない。イベントログを見ると一応対象として認識されているのだが…
Powershell から外部ファイルを実行するにはいくつか方法があるが、以下のように実行するとダメなようだった。
$proc = New-Object "System.Diagnostics.Process" $psi = New-Object "System.Diagnostics.ProcessStartInfo" $psi.FileName = $emocheck_Exe $psi.Arguments = "-output $reportDir -quiet -json" $psi.CreateNoWindow = $true; $psi.UseShellExecute = $false $psi.WindowStyle = [System.Diagnostics.ProcessWindowStyle]::Hidden $proc.StartInfo = $psi $proc.Start() 以下のように設定することでログイン時に実行されるようになった。
Start-Process -WindowStyle Hidden -FilePath $emocheck_Exe -ArgumentList "-output $reportDir -quiet -json" -WorkingDirectory $currentDir</p></div><footer class=entry-footer><span title='2022-03-23 00:00:00 +0900 +0900'>March 23, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;tack41</footer><a class=entry-link aria-label="post link to Active Directoryでログイン時にPowershell経由でexeを実行" href=https://blog.tack41.net/posts/2022/03/23_01/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Google Cloud Identity FreeでChromebook運用時の注意点</h2></header><div class=entry-content><p>TL;DR 物理的な質感はFire TVよりよい。 機能的にはちょい劣る 素のChromecast(with Google TVじゃない方)とは完全に上位互換 Googleへのこだわりがなく、Amazon Primeの機能を利用するのであればFire TVが無難か 経緯 現在2台のモニタにFire TV Stick(無印,4K)を利用しています。妻の実家に使用しなくなったChromecastを譲渡して使ってもらっているのですが、Google Photoの動画のキャスト時にかなりの確率で止まってしまう等パフォーマンスに難が出てきたので最新のChromecast with Google TVを買って解消できないかと思い購入しました。
LANアダプタもセットで。計10,000ほどで、高かったかも。
昨年Pixel6を購入していてクーポンが余っていたため、使ってしまおうという動機もありました。
せっかくなので、手持ちのFire TV Stickとの比較もしてみました。自分の使用用途しか考慮していません。
比較 Fire TV Stick Chromecast with Google TV Chromecast 備考 YouTube OK OK NG 機器単体での再生 AmazonPrime OK OK NG 機器単体での再生 GoogleCast AirReciever等でOK OK OK Kids制限 OK OK - 複数アカウント OK OK - AirPlay AirReciever等でOK AirReciever等でOK NG 写真の選択表示 OK(Amazon photos) NG(壁紙設定のみ) NG(同左) 実家でCastに利用しているのはiPhone,iPadなのでAirPlayで動画を再生できればよかったのですが、AirRecieverではそもそもGooglePhotoの画面を表示できませんでした。他のスマホの操作画面であれば映るのですが…
AirRecieverはソフト自体は有名ですが作者の情報が不明で、利用には不安を感じているのですが、GoogleCastが目的であればChromecast系では利用せずに済みます。
Chromecast with Google TVについて 色を白じゃないのを買ったのですが、電源ケーブルとアダプタは白だった… だったら販売も白だけにしてくれよと思う… 箱や質感はさすがGoogleといった感じで、Fire TV Stickよりよいです。 Googleアカウントのパスワードに「{」という記号を含んでいたのですが、どうもその場合に相性が悪いらしくGoogleアカウントの登録がエラーに。さらにリモコンで手動で登録しようとしてもこの記号がソフトウェアキーボードに表示されない… 仕方ないのでGoogleアカウントのパスワードを変更しました。 写真(Google Photos)を機器単体で自由に選んで表示することができない。壁紙、スクリーンセーバーとしてしか設定できない。これができれば自分でとった写真や動画を大画面で見られて最高なのに、なぜGoogleはやらないんだろう… 結論 Fire TV StickになくてChromecast with Google TVにしかできない機能は見当たらない。逆はある。質感、ブランドなどにこだわりがなければFire TV Stickのほうが良さそう。...</p></div><footer class=entry-footer><span title='2022-01-06 00:00:00 +0900 +0900'>January 6, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;tack41</footer><a class=entry-link aria-label="post link to Google Cloud Identity FreeでChromebook運用時の注意点" href=https://blog.tack41.net/posts/2022/01/06_01/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Google Cloud Identity FreeでChromebook運用時の注意点</h2></header><div class=entry-content><p>TL;DR Google Cloud Identity Freeで作ったアカウントをChromebookで利用すると、個人で作ったアカウントとは初期値等が異なります。
経緯 リモート接続用の端末をコストを抑えて運用するため、Google Cloud Identity Freeでアカウントを作成してChromebookに利用しています。できることは制限されますが、紛失時にアカウントをロックして利用できなくするくらいのことはできます。
個人でもChromebookを利用しているのですが、いくつか初期値などが異なっていました。
Google Driveが利用できない Admin Consoleで、[アプリ]-[Google Workspace]-[サービスのステータス]で「ドライブとドキュメント」がオフになっていたので、オンにすることで利用できるようになります。Driveのファイルを操作するSpreadsheetやDocumentも同時に利用可能になります。
PINログインが設定できない Admin Consoleで、[デバイス]-[Chrome]-[設定]-[ユーザーとブラウザ]で[セキュリティ]-[ロックのクイック解除]で「PIN」にチェックを入れると利用できるようになります。
https://office-kabu.jp/chromebook/gsuite-pin-fingerprint-setting-01
マルチログインで2番目にログインできない 初期値では、マルチログインで、最初のセッションとしてはログインできますが、2番めのセッションとしては指定できません。マルチログイン アクセスを管理するを実行します。</p></div><footer class=entry-footer><span title='2021-11-26 00:00:00 +0900 +0900'>November 26, 2021</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;tack41</footer><a class=entry-link aria-label="post link to Google Cloud Identity FreeでChromebook運用時の注意点" href=https://blog.tack41.net/posts/2021/11/26_01/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>AD環境のWindowsをAnsibleで操作する(非AD環境)</h2></header><div class=entry-content><p>TL;DR Active Directryに参加していないWindow10をWSL2のUbuntu20.04にインストールしたAnsibleで操作する環境を構築しました。kerberos認証が必要ない分、AD参加済みの環境よりは簡単な手順でした。
手順 Windows 10 WSL2を有効にし、Ubuntu20.04をインストール
リモート接続を受け付けるための設定(要管理者権限)
Invoke-WebRequest -Uri https://raw.githubusercontent.com/ansible/ansible/devel/examples/scripts/ConfigureRemotingForAnsible.ps1 -OutFile ConfigureRemotingForAnsible.ps1 powershell -ExecutionPolicy RemoteSigned .\ConfigureRemotingForAnsible.ps1 Ubuntu20.04 最新のAnsibleをインストール
sudo apt update sudo apt install software-properties-common sudo apt-add-repository --yes --update ppa:ansible/ansible sudo apt install ansible https://docs.ansible.com/ansible/2.9_ja/installation_guide/intro_installation.html#ubuntu-ansible 以下のaptパッケージのインストール
python3-pip gcc pip3で以下のPythonライブラリをインストール
pywinrm inventory.ymlに以下の記述を記載
windows: hosts: 192.168.yy.yyy: ansible_connection: winrm ansible_user: user_name ansible_winrm_server_cert_validation: ignore ansible_winrm_transport: basic ansible_port: 5986 ansible -i inventory.yml 192.168.yyy.yyy -m win_ping が成功することを確認</p></div><footer class=entry-footer><span title='2021-11-25 00:00:00 +0900 +0900'>November 25, 2021</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;tack41</footer><a class=entry-link aria-label="post link to AD環境のWindowsをAnsibleで操作する(非AD環境)" href=https://blog.tack41.net/posts/2021/11/25_01/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://blog.tack41.net/categories/tech/page/2/>«&nbsp;Prev&nbsp;</a>
<a class=next href=https://blog.tack41.net/categories/tech/page/4/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2022 <a href=https://blog.tack41.net/>tack41's blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>