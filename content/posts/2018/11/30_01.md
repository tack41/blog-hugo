---
title: "Excelでオプションボタン"
date: 2018-11-30T00:00:00Z
categories: [ tech ]
tags: [ excel ]
draft: false
---

利用者が使い慣れたExcelでアンケートシートを作ろうとした際のこと。

どれか1つを選択してほしい場合は、オプションボタンを使う。開発タブにあり、フォームコントロールとActiveXの2つがある。

* フォームコントロール
  - フォントの見た目がActiveXと比べればマシ。
  - グループ化するのに、グループポックスを使用しないといけない。
    - 行や列の追加・削除でグループボックスに入ったり外れたりすると挙動が想定外となる
    - レイアウト上、グループボックスが不要な場合は非表示にしないといけない。が、非表示にするとどこにあったかわからなくなる。
    - 誤ってグループボックスが重なったりするとやはり想定外の挙動となる。

* ActiveX
  - グループ化するのにグループ名を指定できるので、フォームのように想定外の動作をすることはない
  - フォントの見た目がひどい。クリックしたときとそうでないときで大きさが変わる?
  - 項目Aを選択し、項目Bを選択してさらに項目Aを選択...と繰り返すと、**どんどんフォントが大きくなる(致命的)**
    - プロパティ上のフォントサイズは変わっておらず、コントロールのサイズを変更すると直る。
    - 当方では2013で発生。MSも認識はしているらしいが、対応作なし...
[https://support.microsoft.com/ja-jp/help/417966]

ActiveXのフォントが大きくなる不具合は致命的なので、グループボックスの位置に注意しながらフォームコントロールを使うことにした。
どちらの場合もだが、オプションボックスをセル内に収まるようにしないと、セルの追加で配置がずれてしまうので注意。
