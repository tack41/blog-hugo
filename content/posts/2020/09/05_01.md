---
title: "Accessでフォーム起動時に該当列が存在しないエラーの原因究明"
date: 2020-09-05 00:00:00 +0900
categories: [ tech ]
tags: [ access ]
draft: false
---

Access であるフォームを起動時に、特定の列が存在しない旨のエラーが表示された。その原因究明について。

該当フォームのレコードソースを見るとクエリが指定されており、エラーメッセージに表示された列が存在しないことを確認。ただ、どこから参照されているかがわからない。

該当フォームはマクロで起動されていたのでマクロを調べてみたが、フォームを起動する処理のみでおかしなところはない。
該当フォームの全てのコントロールのコントロールソースのプロパティを調べてみたが、エラーとなっている項目を参照している箇所はない。
VBAマクロにて該当フォーム内の全プロシージャを調べてみたが、やはり参照箇所はない。

最終的に、フォームの並び替えのプロパティで参照されていた。
かなり時間がかかってしまったが、次回同じようなことが起こった際には、[ariawase](https://github.com/vbaidiot/ariawase)のようなツールでVBAをエクスポートしたあと、grepするほうが早くて確実だと思う。
