---
title: "Bootcampのセットアップは大変"
date: 2021-10-04 00:00:00 +0900
categories: [ tech ]
tags: [ mac,windows ]
draft: false
---

## TL;DR

MacBook Air Mid 2013でbootcamp上でWindows 10を動かしてそれなりに動作させるのには、以下の作業が必要でした。

1. Windows 10 21H1のISOでBootcampをセットアップ
1. `コンピューターが予期せず再起動されたか...`とエラーが表示されてセットアップが進まなくなるので、Shift+F10キーを押してコマンドプロンプトを起動し、`regedit`を起動して`HKEY_LOCAL_MACHINE\SYSTEM\Setup\Status\ChildCompletion`の`setup.exe`の値を1から3に変更
   * この時点でNICが未認識
1. Mac側のBootcampアシスタントで\[アクション\]-\[Windowsサポートソフトウェアをダウンロード\]より一式ダウンロードしてUSBメモリに保存
1. Windows側でUSBメモリ内のSetup.exeを実行
   * この時点で英数、かなキーを認識できず日本語切り替えがうまくいかない
1. デバイスマネージャーで`Apple Keyboard`をアンインストール。ドライバーのソフトウェアも削除
   * この時点で英語キーボードと認識され、記号の入力がキーボードの印字通りにならない
1. Windowsの\[設定\]-\[時刻と言語]\-\[言語\]の\[優先する言語\]にある「日本語」をクリックして\[オプション\]をクリック。ハードウェアキーボードレイアウトを「英語キーボード(101/102キー)」から「日本語キーボード(106/109キー)に変更

## 経緯

奥さんが利用しているMac Book Air(Mid 2013)が128GBで、容量不足で作業が滞るため、余っていた1TB SSDに交換しました。

が、このモデル、現時点ではサポート終了で最新バージョンにアップグレードできない... 最新のMac買えばと薦めたのですが、最近ほとんど使わないので要らないとのこと。もったいないのでBootcampでWindows 10を入れて2025年までは延命させようと作業しました。

このモデルではHigh Sierraまでしかサポートされていません。この状態でBootcampアシスタントでWindows 10 21H1のISOを利用してBootcampを実行すると、途中ハードウェアの認識エラーにより先に進まなくなります。

https://asterisk-works.com/how-to-install-boot-camp-on-macbook-nvme-ssd/

を参考にレジストリ値を変更することでとりあえずエラーは回避。ですがこの状態だとドライバがまともに入っていないようで、NIC未認識によりアップデートもできない状態。

Mac側でBootcampアシスタントで[アクション]-[Windowsサポートソフトウェアをダウンロード]より一式ダウンロードしてWindowsで認識できるFATフォーマットのUSBメモリに保存。3GB弱ありました。で、Windows側でSetup.exeを実行し、再起動させてNICをはじめ各種HWは認識されました。

日本語変換がうまくいきません。IMEの設定で無変換キー、ひらがなキーにIME-OFF/ONの設定をしてもダメ。インストールされたキーボードドライバではキーの認識がうまくいっていないようでした。そこでデバイスマネージャーで`Apple Keyborad`をアンインストール、ドライバーソフトウェアの削除のチェックボックスも入れて再起動すると、認識するようになりました。

https://i-tsunagu.com/mac/keyboard-notrecognize/

が、記号類の認識がおかしい。「@」を入力しようとするとShift+2を実行する必要がある状態。英語キーボードとして認識されているようなので、Windowsの[設定]-[時刻と言語]-[言語]の[優先する言語]にある「日本語」をクリックして[オプション]をクリック。ハードウェアキーボードレイアウトを「英語キーボード(101/102キー)」から「日本語キーボード(106/109キー)に変更してキーボードの印字通りに入力できるようになりました。

いろんなサイトを調べながら結構大変な作業でした。これは素人では無理。最新でないHigh Sierraで実行したこともあるのかもしれませんが、Bootcampアシスタントというお手軽そうなツールがあるからと気軽に手を出すと痛い目を見るな(自分含め)と思いました。
